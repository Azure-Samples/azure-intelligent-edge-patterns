(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{688:function(e,t,n){e.exports=n(939)},697:function(e,t,n){},937:function(e,t,n){},939:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(43),o=n.n(i),l=n(20),u=n(467),s=(n(697),n(85)),d=n(468),m=n(469),g=n(259),f=n(470),p=n.n(f);!function(e){e.None="none",e.WaitTraining="waitTraining",e.FinishTraining="finishTraining",e.TrainingFailed="trainingFailed",e.StartInference="startInference"}(a||(a={}));var E,h,b,v,y,O={dialogIsOpen:!1,cameras:[],locations:[],images:[],labelingPageState:{annotations:[]},part:{capturedImages:[],isValid:!0},project:{isLoading:!1,data:{id:null,camera:null,location:null,parts:[],needRetraining:!0,accuracyRangeMin:60,accuracyRangeMax:80,maxImages:50,modelUrl:""},trainingMetrics:{prevConsequence:null,curConsequence:null},inferenceMetrics:{successRate:null,successfulInferences:null,unIdetifiedItems:null},status:a.None,error:null,trainingLog:""}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.cameras,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CAMERA_SUCCESS":return t.payload;case"REQUEST_CAMERA_FAILURE":return e;case"POST_CAMERA_SUCCESS":return e.concat(t.payload);case"DELETE_CAMERA_SUCCESS":var n=e.findIndex((function(e){return e.id===t.payload.id}));return-1!==n?e.slice(0,n).concat(e.slice(n+1)):e;default:return e}},S=n(129),I=n(18),j=(E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.part,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CAPTURED_IMAGE":return Object(I.a)({},e,{capturedImages:[].concat(Object(S.a)(e.capturedImages),[t.payload.newCapturedImage])});case"UPDATE_CAPTURED_IMAGES":return Object(I.a)({},e,{capturedImages:t.payload.capturedImages});default:return e}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.part,t=arguments.length>1?arguments[1]:void 0,n=E(e,t),a=n.capturedImages.filter((function(e){return e.labels})).length>=15;return Object(I.a)({},n,{isValid:a})});!function(e){e.Empty="Empty",e.P1Added="P1Added",e.Finish="Finish"}(h||(h={})),function(e){e.default="default",e.pointer="pointer",e.crosshair="crosshair",e.neswResize="nesw-resize",e.nwseResize="nwse-resize"}(b||(b={})),function(e){e.Creating="Creating",e.Selecting="Selecting",e.None="None"}(v||(v={})),function(e){e[e.SingleAnnotation=0]="SingleAnnotation",e[e.MultiAnnotation=1]="MultiAnnotation"}(y||(y={}));var T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.labelingPageState,t=arguments.length>1?arguments[1]:void 0,n=e;switch(t.type){case"REQUEST_ANNOTATION_SUCCESS":n.annotations=t.payload.annotations;break;case"REQUEST_ANNOTATION_FAILURE":break;case"CREATE_ANNOTATION":n.annotations.push(t.payload.annotation);break;case"UPDATE_CREATING_ANNOTATION":var a=t.payload.updater(n.annotations[n.annotations.length-1]);a.annotationState===h.Finish&&((0|a.label.x1)===(0|a.label.x2)&&(0|a.label.y1)===(0|a.label.y2)?n.annotations.pop():(n.annotations[n.annotations.length-1]=a,n.annotations=Object(S.a)(n.annotations)));break;case"UPDATE_ANNOTATION":n.annotations[t.payload.index]=t.payload.annotation;break;case"REMOVE_ANNOTATION":n.annotations=n.annotations.slice(0,t.payload.index).concat(n.annotations.slice(t.payload.index+1));break;case"RESET_ANNOTATION":n.annotations=O.labelingPageState.annotations;break;default:return e}return n},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.locations,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_LOCATION_SUCCESS":return t.payload;case"REQUEST_LOCATION_FAILURE":return e;case"POST_LOCATION_SUCCESS":return e.concat(t.payload);default:return e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.dialogIsOpen,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_DIALOG":return!0;case"CLOSE_DIALOG":return!1;default:return e}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.project,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_PROJECT_REQUEST":return Object(I.a)({},e,{isLoading:!0,error:null});case"GET_PROJECT_SUCCESS":return Object(I.a)({},e,{isLoading:!1,data:Object(I.a)({},t.payload.project),error:null});case"GET_PROJECT_FAILED":return Object(I.a)({},e,{isLoading:!1,error:t.error});case"POST_PROJECT_REQUEST":return Object(I.a)({},e,{isLoading:!0});case"POST_PROJECT_SUCCESS":return Object(I.a)({},e,{isLoading:!1});case"POST_PROJECT_FALIED":return Object(I.a)({},e,{isLoading:!1,error:t.error});case"DELETE_PROJECT_SUCCESS":return Object(I.a)({},e,{isLoading:!1,data:{id:null,camera:null,location:null,parts:[],needRetraining:!0,accuracyRangeMin:60,accuracyRangeMax:80,maxImages:50,modelUrl:""},inferenceMetrics:{successRate:0,successfulInferences:0,unIdetifiedItems:0},trainingMetrics:{curConsequence:null,prevConsequence:null},trainingLog:"",status:a.None,error:null});case"DELETE_PROJECT_FALIED":return Object(I.a)({},e);case"UPDATE_PROJECT_DATA":return Object(I.a)({},e,{data:t.payload});case"GET_TRAINING_LOG_REQUEST":return Object(I.a)({},e);case"GET_TRAINING_LOG_SUCCESS":return Object(I.a)({},e,{trainingLog:t.payload.trainingLog,status:t.payload.newStatus});case"GET_TRAINING_LOG_FAILED":return Object(I.a)({},e,{trainingLog:"",data:Object(I.a)({},e.data),status:a.TrainingFailed,error:t.error});case"GET_TRAINING_METRICS_REQUEST":return e;case"GET_TRAINING_METRICS_SUCCESS":return Object(I.a)({},e,{trainingMetrics:t.payload,status:a.StartInference});case"GET_TRAINING_METRICS_FAILED":return Object(I.a)({},e,{error:t.error});case"GET_TRAINING_INFERENCE_REQUEST":return e;case"GET_INFERENCE_METRICS_SUCCESS":return Object(I.a)({},e,{inferenceMetrics:t.payload});case"GET_INFERENCE_METRICS_FAILED":return Object(I.a)({},e,{error:t.error});default:return Object(I.a)({},e)}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.images,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_LABEL_IMAGE_SUCCESS":return t.payload;case"REQUEST_LABEL_IMAGE_FAILURE":return e;case"POST_LABEL_IMAGE_SUCCESS":return e.concat(t.payload);case"DELETE_LABEL_IMAGE_SUCCESS":var n=e.findIndex((function(e){return e.id===t.payload.id}));return-1!==n?e.slice(0,n).concat(e.slice(n+1)):e;case"UPDATE_LABEL_IMAGE_ANNOTATION":var a=Object(S.a)(e),r=a.findIndex((function(e){return e.id===t.payload.id}));return a[r]=Object(I.a)({},a[r],{labels:t.payload.labels}),a;default:return e}},R=Object(s.combineReducers)({cameras:C,locations:x,part:j,labelingPageState:T,dialogIsOpen:A,project:_,images:w}),k={key:"root",storage:p.a},L=Object(g.a)(k,R),N=function(e){var t=[d.a],n=s.applyMiddleware.apply(void 0,t),a=Object(m.composeWithDevTools)(n),r=Object(s.createStore)(L,e,a);return{store:r,persistor:Object(g.b)(r)}},P=n(31),M=n(236),D=n(131),U=n(162),F=n(79),G=n(84),z=function(e){var t=e.to,n=void 0===t?"":t,a=e.imgSrc,r=e.defaultSrc,i=e.bgImgSrc,o=e.label,l=void 0===o?"":o,u=e.imgPadding,s=void 0===u?"10px":u,d=e.width,m=void 0===d?"100px":d,g=e.height,f=void 0===g?"100px":g,p=e.bgImgStyle,E=e.pointerCursor,h=void 0!==E&&E,b=e.onClick;return c.a.createElement(U.a,{column:!0,styles:{width:m}},""===n?c.a.createElement("div",{style:{height:f},onClick:b},c.a.createElement(G.a,{src:null!==a&&void 0!==a?a:r,styles:Object(I.a)({padding:s,height:"100%",objectFit:"contain",backgroundImage:"url(".concat(i,")"),cursor:h?"pointer":"default"},p)})):c.a.createElement(P.b,{to:n},c.a.createElement("div",{style:{height:f},onClick:b},c.a.createElement(G.a,{src:null!==a&&void 0!==a?a:r,styles:Object(I.a)({padding:s,height:"100%",objectFit:"contain",backgroundImage:"url(".concat(i,")")},p)}))),c.a.createElement(F.a,{align:"center"},l))},J=function(){var e=Object(l.b)();return c.a.createElement(U.a,{column:!0,gap:"gap.medium"},c.a.createElement(F.a,{size:"larger",weight:"semibold"},"Hello User!"),c.a.createElement(F.a,null),c.a.createElement(F.a,{color:"white",styles:{backgroundColor:"#373644",padding:"2px 2px 2px 10px"}},"GET STARTED:"),c.a.createElement(U.a,{gap:"gap.large"},c.a.createElement(z,{imgSrc:"/icons/location-filled.png",to:"/locations/register",label:"Register a new Location",width:"100px"}),c.a.createElement(z,{imgSrc:"/icons/camera-filled.png",to:"/cameras",label:"Register a new Camera",width:"100px",imgPadding:"10px 3px 10px 3px",onClick:function(){e({type:"OPEN_DIALOG"})}}),c.a.createElement(z,{imgSrc:"/icons/part-filled.png",to:"/parts/detail",label:"Register a new Part",width:"100px"})),c.a.createElement(F.a,{color:"white",styles:{backgroundColor:"#373644",padding:"2px 2px 2px 10px"}},"SELECT FROM THE FOLLOWING TASKS:"),c.a.createElement(U.a,{gap:"gap.large"},c.a.createElement(z,{imgSrc:"/icons/doubleCube.png",to:"/partIdentification",label:"Identify Parts",width:"100px"}),c.a.createElement(z,{imgSrc:"/icons/defects.png",to:"/",label:"Identify Defects",width:"100px"}),c.a.createElement(z,{imgSrc:"/icons/manual-filled.png",to:"/manual",label:"Identify items manually",width:"100px"})))},B=n(17),V=n(228),H=n(238),Q=n(68),W=n(23),q=n(177),Y=n(37),X=n.n(Y),K=function(e){return console.error(e),{type:"REQUEST_CAMERA_FAILURE"}},$=function(){return function(e){return X()("/api/cameras/").then((function(t){var n=t.data;e(function(e){return{type:"GET_CAMERA_SUCCESS",payload:e}}(n))})).catch((function(t){e(K(t))}))}},Z=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return{dialogIsOpen:e.dialogIsOpen,cameras:e.cameras}})),n=t.dialogIsOpen,a=t.cameras,i=Object(r.useState)(""),o=Object(B.a)(i,2),u=o[0],s=o[1],d=Object(r.useState)(""),m=Object(B.a)(d,2),g=m[0],f=m[1],p=Object(r.useState)(""),E=Object(B.a)(p,2),h=E[0],b=E[1];return Object(r.useEffect)((function(){e($())}),[e]),c.a.createElement(U.a,{column:!0,gap:"gap.large",padding:"padding.medium",styles:{height:"100%"}},c.a.createElement(V.a,{columns:"8",styles:{height:"75%"}},a.map((function(e,t){return c.a.createElement(z,{key:t,to:"/cameras/detail?name=".concat(e.name),defaultSrc:"/icons/Play.png",bgImgSrc:"/icons/defaultCamera.png",width:"100px",height:"100px",bgImgStyle:{backgroundSize:"60%",backgroundPosition:"center",backgroundRepeat:"no-repeat"},label:e.name})}))),c.a.createElement(H.a,{trigger:c.a.createElement(U.a,{hAlign:"end"},c.a.createElement(Q.a,{primary:!0,fluid:!0,circular:!0,content:c.a.createElement(W.AddIcon,{size:"largest",circular:!0}),style:{width:"6em",height:"6em"}})),confirmButton:"Submit",onConfirm:function(){var t;e((t={name:u,rtsp:g,model_name:h},function(e){return X()("/api/cameras/",{method:"POST",data:t}).then((function(t){var n=t.data;e(function(e){return{type:"POST_CAMERA_SUCCESS",payload:e}}(n))})).catch((function(t){e(K(t))}))})),s(""),f(""),b(""),e({type:"CLOSE_DIALOG"})},cancelButton:"Cancel",header:"Add Camera",open:n,onOpen:function(){e({type:"OPEN_DIALOG"})},onCancel:function(){e({type:"CLOSE_DIALOG"})},content:c.a.createElement(U.a,{column:!0,gap:"gap.small"},c.a.createElement(q.a,{placeholder:"Name",value:u,onChange:function(e,t){return s(t.value)}}),c.a.createElement(q.a,{placeholder:"RTSP URL",value:g,onChange:function(e,t){return f(t.value)}}),c.a.createElement(q.a,{placeholder:"Model Name",value:h,onChange:function(e,t){return b(t.value)}}))}))},ee=function(e){var t=e.trigger,n=e.onConfirm,a=e.primaryStyles,i=e.content,o=Object(r.useState)(!1),l=Object(B.a)(o,2),u=l[0],s=l[1];return c.a.createElement(H.a,{trigger:t,styles:{width:"20em",padding:"0.5em"},open:u,onOpen:function(){return s(!0)},footer:c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement(F.a,{size:"large",align:"center"},i),c.a.createElement(U.a,{space:"around"},c.a.createElement(Q.a,{primary:!0,content:"Confirm",styles:a,onClick:n}),c.a.createElement(Q.a,{content:"Cancel",onClick:function(){return s(!1)}})))})},te=Object(r.memo)((function(e){var t=e.id,n=e.name,a=e.rtsp,r=e.modelName,i=Object(l.b)();return c.a.createElement(U.a,{styles:{padding:"1em 2em"},column:!0,space:"between"},c.a.createElement(V.a,{columns:"2",styles:{gap:"3em"}},c.a.createElement(F.a,{size:"larger",weight:"semibold"},"Details"),c.a.createElement(z,{defaultSrc:"/icons/defaultCamera.png",width:"100px",height:"100px"}),c.a.createElement(U.a,{column:!0,gap:"gap.small"},c.a.createElement(F.a,{size:"large",content:"Name:"}),c.a.createElement(F.a,{size:"large",content:"RTSP Url:"}),c.a.createElement(F.a,{size:"large",content:"Model:"})),c.a.createElement(U.a,{column:!0,gap:"gap.medium"},c.a.createElement(F.a,{size:"large",content:n}),c.a.createElement(F.a,{size:"large",content:a}),c.a.createElement(F.a,{size:"large",content:r}))),c.a.createElement(ee,{trigger:c.a.createElement(Q.a,{primary:!0,content:"Delete Camera",styles:{backgroundColor:"#C4314B",":hover":{backgroundColor:"#A72037"},":active":{backgroundColor:"#8E192E"}}}),content:"Delete Camera",primaryStyles:{backgroundColor:"#C4314B",":hover":{backgroundColor:"#A72037"},":active":{backgroundColor:"#8E192E"}},onConfirm:function(){i(function(e){return function(t){return X()("/api/cameras/".concat(e,"/"),{method:"DELETE"}).then((function(){t(function(e){return{type:"DELETE_CAMERA_SUCCESS",payload:{id:e}}}(e))})).catch((function(e){t(K(e))}))}}(t))}}))})),ne=n(237),ae=n(106),re=n(239),ce=function(e,t){var n=Object(r.useRef)(null);Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])},ie=function(e,t){return{type:"GET_TRAINING_LOG_SUCCESS",payload:{trainingLog:e,newStatus:t}}},oe=function(){return function(e){return e({type:"GET_PROJECT_REQUEST"}),X.a.get("/api/projects/").then((function(t){var n,a,r,c,i,o,l,u,s,d,m,g,f,p,E,h,b,v,y=t.data,O={id:null!==(n=null===(a=y[0])||void 0===a?void 0:a.id)&&void 0!==n?n:null,camera:null!==(r=parseInt(null===(c=y[0])||void 0===c?void 0:c.camera.split("/")[5],10))&&void 0!==r?r:null,location:null!==(i=parseInt(null===(o=y[0])||void 0===o?void 0:o.location.split("/")[5],10))&&void 0!==i?i:null,parts:null!==(l=null===(u=y[0])||void 0===u?void 0:u.parts.map((function(e){return parseInt(e.split("/")[5],10)})))&&void 0!==l?l:[],modelUrl:null!==(s=null===(d=y[0])||void 0===d?void 0:d.download_uri)&&void 0!==s?s:"",needRetraining:null===(m=null===(g=y[0])||void 0===g?void 0:g.needRetraining)||void 0===m||m,accuracyRangeMin:null!==(f=null===(p=y[0])||void 0===p?void 0:p.accuracyRangeMin)&&void 0!==f?f:60,accuracyRangeMax:null!==(E=null===(h=y[0])||void 0===h?void 0:h.accuracyRangeMax)&&void 0!==E?E:80,maxImages:null!==(b=null===(v=y[0])||void 0===v?void 0:v.maxImages)&&void 0!==b?b:50};e(function(e){return{type:"GET_PROJECT_SUCCESS",payload:{project:e}}}(O))})).catch((function(t){e({type:"GET_PROJECT_FAILED",error:t})}))}},le=function(e){X.a.get("/api/projects/".concat(e,"/train")).catch((function(e){return console.error(e)}))},ue=function(e){return function(t){return t({type:"GET_TRAINING_LOG_REQUEST"}),X.a.get("/api/projects/".concat(e,"/export")).then((function(e){var n=e.data;if("failed"===n.status)throw new Error(n.log);"ok"===n.status?t(ie("",a.FinishTraining)):t(ie(n.log,a.WaitTraining))})).catch((function(e){return t({type:"GET_TRAINING_LOG_FAILED",error:e})}))}},se=function(){var e=Object(r.useState)([]),t=Object(B.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){fetch("/api/parts/").then((function(e){return e.json()})).then((function(e){a(e)})).catch((function(e){console.error(e)}))}),[]),n},de=function(){return new URLSearchParams(Object(D.i)().search)},me=function(e){var t,n,i,o,u,s,d=e.projectId,m=Object(l.c)((function(e){return e.project})),g=m.error,f=m.data,p=m.trainingLog,E=m.status,h=m.trainingMetrics,b=m.inferenceMetrics,v=ge(p),y=se(),O=Object(l.b)(),C=de().get("name"),S=Object(D.h)(),I=Object(r.useCallback)((function(){confirm("Delete this configuration?")&&O(function(e){return function(t){return X.a.delete("/api/projects/".concat(e,"/")).then((function(){return t({type:"DELETE_PROJECT_SUCCESS"})})).catch((function(e){alert(e),t({type:"DELETE_PROJECT_FALIED"})}))}}(d)).then((function(e){if(e)return S.push("/cameras/detail?name=".concat(C))})).catch((function(e){return console.error(e)}))}),[O,S,C,d]);Object(r.useEffect)((function(){O(ue(d))}),[O,d]),ce((function(){O(ue(d))}),E===a.WaitTraining?5e3:null),Object(r.useEffect)((function(){E===a.FinishTraining&&O(function(e){return function(t){return t({type:"GET_TRAINING_METRICS_REQUEST"}),X.a.get("/api/projects/".concat(e,"/train_performance")).then((function(e){var n=e.data,a=n.new?{precision:n.new.precision,recall:n.new.recall,mAP:n.new.map}:null,r=n.previous?{precision:n.previous.precision,recall:n.previous.recall,mAP:n.previous.map}:null;return t(function(e,t){return{type:"GET_TRAINING_METRICS_SUCCESS",payload:{prevConsequence:t,curConsequence:e}}}(a,r))})).catch((function(e){return t({type:"GET_TRAINING_METRICS_FAILED",error:e})}))}}(d))}),[O,E,d]),ce((function(){O(function(e){return function(t){return t({type:"GET_TRAINING_INFERENCE_REQUEST"}),X.a.get("/api/projects/".concat(e,"/export")).then((function(e){var n,a,r,c=e.data;return t((n=c.success_rate,a=c.inference_num,r=c.unidentified_num,{type:"GET_INFERENCE_METRICS_SUCCESS",payload:{successRate:n,successfulInferences:a,unIdetifiedItems:r}}))})).catch((function(e){return t({type:"GET_INFERENCE_METRICS_FAILED",error:e})}))}}(d))}),E===a.StartInference?5e3:null);var j=[a.FinishTraining,a.StartInference].includes(E);return c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement("h1",null,"Configuration"),g&&c.a.createElement(ne.a,{danger:!0,header:g.name,content:"".concat(g.message)}),E===a.WaitTraining?c.a.createElement(c.a.Fragment,null,c.a.createElement(ae.a,{size:"smallest"}),c.a.createElement("pre",null,v)):c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Status"},c.a.createElement(Ee,{online:j})),c.a.createElement(pe,{title:"Configured for"},y.filter((function(e){return f.parts.includes(e.id)})).map((function(e){return e.name})).join(", ")),c.a.createElement(U.a,{column:!0,gap:"gap.small"},c.a.createElement(F.a,{styles:{width:"150px"},size:"large"},"Live View:"),c.a.createElement("div",{style:{width:"100%",height:"600px",backgroundColor:"black"}},j?c.a.createElement(G.a,{src:"http://".concat(window.location.hostname,":5000/video_feed?inference=1"),styles:{width:"100%",height:"100%",objectFit:"contain"}}):null)),c.a.createElement(pe,{title:"Success Rate"},c.a.createElement(F.a,{styles:{color:"rgb(244, 152, 40)",fontWeight:"bold"},size:"large"},"".concat(b.successRate,"%"))),c.a.createElement(pe,{title:"Successful Inferences"},b.successfulInferences),c.a.createElement(pe,{title:"Unidentified Items"},c.a.createElement(F.a,{styles:{margin:"5px"},size:"large"},b.unIdetifiedItems),c.a.createElement(Q.a,{content:"Identify Manually",primary:!0,styles:{backgroundColor:"red",marginLeft:"100px",":hover":{backgroundColor:"#A72037"},":active":{backgroundColor:"#8E192E"}},as:P.b,to:"/manual"})),h.prevConsequence&&c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,null,"Previous Model Metrics"),c.a.createElement(fe,{precision:null===(t=h.prevConsequence)||void 0===t?void 0:t.precision,recall:null===(n=h.prevConsequence)||void 0===n?void 0:n.recall,mAP:null===(i=h.prevConsequence)||void 0===i?void 0:i.mAP})),c.a.createElement(F.a,null,"Updated Model Metrics"),c.a.createElement(fe,{precision:null===(o=h.curConsequence)||void 0===o?void 0:o.precision,recall:null===(u=h.curConsequence)||void 0===u?void 0:u.recall,mAP:null===(s=h.curConsequence)||void 0===s?void 0:s.mAP}),c.a.createElement(Q.a,{primary:!0,onClick:I},"Delete Configuration"),c.a.createElement(Q.a,{primary:!0,as:P.b,to:"/partIdentification"},"Edit Configuration")))},ge=function(e){var t=Object(r.useState)(e),n=Object(B.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){c((function(t){return"".concat(t,"\n").concat(e)}))}),[e]),a},fe=function(e){var t=e.precision,n=e.recall,a=e.mAP;return c.a.createElement(V.a,{columns:3},c.a.createElement("div",{style:{height:"5em",display:"flex",flexFlow:"column",justifyContent:"space-between"}},c.a.createElement(F.a,{align:"center",size:"large",weight:"semibold"},"Precison"),c.a.createElement(F.a,{align:"center",size:"large",weight:"semibold",styles:{color:"#9a0089"}},null===t?"":"".concat((1e3*t|0)/10,"%"))),c.a.createElement("div",{style:{height:"5em",display:"flex",flexFlow:"column",justifyContent:"space-between"}},c.a.createElement(F.a,{align:"center",size:"large",weight:"semibold"},"Recall"),c.a.createElement(F.a,{align:"center",size:"large",weight:"semibold",styles:{color:"#0063b1"}},null===n?"":"".concat((1e3*n|0)/10,"%"))),c.a.createElement("div",{style:{height:"5em",display:"flex",flexFlow:"column",justifyContent:"space-between"}},c.a.createElement(F.a,{align:"center",size:"large",weight:"semibold"},"mAP"),c.a.createElement(F.a,{align:"center",size:"large",weight:"semibold",styles:{color:"#69c138"}},null===a?"":"".concat((1e3*a|0)/10,"%"))))},pe=function(e){var t=e.title,n=e.children;return c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{style:{width:"200px"},size:"large"},"".concat(t,": ")),"string"===typeof n||"number"===typeof n?c.a.createElement(F.a,{size:"large"},n):n)},Ee=function(e){var t=e.online,n=t?"Online":"Offline",a=t?"success":"unknown";return c.a.createElement(U.a,{gap:"gap.smaller",vAlign:"center"},c.a.createElement(re.a,{state:a}),c.a.createElement(F.a,{styles:{margin:"5px"},size:"large"},n))},he=function(){return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement("h1",null,"Configuration"),c.a.createElement(U.a,{hAlign:"center",vAlign:"center",design:{height:"100%"},column:!0,gap:"gap.large"},c.a.createElement(Q.a,{fluid:!0,circular:!0,content:c.a.createElement(W.AddIcon,{size:"largest",circular:!0,color:"brand"}),style:{width:100,height:100,border:"5px solid #0094d8"},color:"brand",as:P.b,to:"/partIdentification"}),c.a.createElement("h2",null,"Configure Task for the Device")))},be=function(){var e=Object(l.c)((function(e){return e.project.data.camera})),t=Object(l.c)((function(e){return e.project.data.id})),n=Object(l.b)(),a=de().get("name"),i=Object(l.c)((function(e){return e.cameras.find((function(e){return e.name===a}))}));if(Object(r.useEffect)((function(){n(oe()),n($())}),[n]),!i)return c.a.createElement(D.b,{to:"/cameras"});var o=e===i.id;return c.a.createElement(V.a,{columns:"2",design:{height:"100%"}},c.a.createElement(te,{id:i.id,name:a,rtsp:i.rtsp,modelName:i.model_name}),o?c.a.createElement(me,{projectId:t}):c.a.createElement(he,null))},ve=n(240),ye=n(121),Oe=n(173),Ce=n(42),Se={image:void 0,status:"loading",size:{width:0,height:0}},Ie=function(e,t){var n=Object(r.useState)(Se),a=Object(B.a)(n,2),c=a[0],i=a[1],o=c.image,l=c.status,u=c.size,s=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current}(e);return Object(r.useEffect)((function(){if(e){var n=document.createElement("img");e!==s&&i((function(e){return Object(I.a)({},e,{image:e.image,status:"loading"})}));var a=function(){i({image:n,status:"loaded",size:{width:n.width,height:n.height}})},r=function(){i((function(e){return Object(I.a)({},e,{image:void 0,status:"failed"})}))};return n.addEventListener("load",a),n.addEventListener("error",r),t&&(n.crossOrigin=t),n.src=e,function(){n.removeEventListener("load",a),n.removeEventListener("error",r)}}}),[e,t,s]),[o,l,u]},je=function(e){return function(t){if(0!==t.width){if(t.width>t.height){var n=e.width/t.width;return[{width:e.width,height:t.height*n},n]}var a=e.height/t.height;return[{height:e.height,width:t.width*a},a]}return[e,1]}},Te=n(146),xe=function(e){return{type:"REQUEST_ANNOTATION_SUCCESS",payload:{annotations:e}}},Ae={init:function(){return{label:{x1:0,y1:0,x2:0,y2:0},attribute:"",annotationState:h.Empty}},createWithPoint:function(e,t){var n=Object(I.a)({},this.init(),{attribute:t});return this.add(e,n)},add:function(e,t){var n=e.x,a=e.y,r=Object(I.a)({},t);return t.annotationState===h.Empty?(r.label.x1=n,r.label.y1=a,r.label.x2=n,r.label.y2=a,r.annotationState=h.P1Added):t.annotationState===h.P1Added&&(r.label.x2=n,r.label.y2=a,r.annotationState=h.Finish),this.setVerticesToValidValue(r)},setVerticesToInt:function(e){var t=Object(I.a)({},e),n=t.label,a=n.x1,r=n.y1,c=n.x2,i=n.y2;return t.label={x1:Math.round(a),y1:Math.round(r),x2:Math.round(c),y2:Math.round(i)},t},setVerticesPointsOrder:function(e){var t=Object(I.a)({},e),n=t.label,a=n.x1,r=n.y1,c=n.x2,i=n.y2;return a>c&&(t.label.x1=c,t.label.x2=a),r>i&&(t.label.y1=i,t.label.y2=r),t},setVerticesToValidValue:function(e){return this.setVerticesPointsOrder(this.setVerticesToInt(e))}},_e=function(e){var t=e.scale,n=e.workState,a=e.onSelect,i=e.selected,o=e.annotationIndex,l=e.visible,u=void 0===l||l,s=e.annotation,d=e.dispatch,m=e.changeCursorState,g=void 0===m?null:m,f=Object(r.useState)(s.label),p=Object(B.a)(f,2),E=p[0],h=p[1],y=5/t,O=2/t,C=Object(r.useRef)(null),S=function(){if(g(),d){var e=Object(I.a)({},s);e.label=E,d(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return{type:"UPDATE_ANNOTATION",payload:{index:e,annotation:Ae.setVerticesToValidValue(t)}}}(o,e))}},j=Object(r.useCallback)((function(e){n===v.Creating&&i&&h((function(n){return Object(I.a)({},n,{x2:e.evt.offsetX/t,y2:e.evt.offsetY/t})}))}),[n,h,i,t]),T=Object(r.useCallback)((function(e){var n=e.xi,a=void 0===n?"x1":n,r=e.yi,c=void 0===r?"y1":r;return function(e){var n=e.target.getStage().getSize(),r=n.width,i=n.height,o=Math.round(e.target.position().x),l=Math.round(e.target.position().y);o<0&&(o=0),l<0&&(l=0),o>r/t&&(o=r/t),l>i/t&&(l=i/t),e.target.setAttr("x",o),e.target.setAttr("y",l);var u=["x1","x2"],s=["y1","y2"];u.splice(u.findIndex((function(e){return e===a})),1),s.splice(s.findIndex((function(e){return e===c})),1),E[u[0]]>E[a]?E[s[0]]>E[c]?g(b.nwseResize):g(b.neswResize):E[s[0]]>E[c]?g(b.neswResize):g(b.nwseResize),h((function(e){var t;return Object(I.a)({},e,(t={},Object(Te.a)(t,a,o),Object(Te.a)(t,c,l),t))}))}}),[g,t,E]);return Object(r.useEffect)((function(){var e=C.current.getLayer();return e.on("mousemove",j),function(){e.off("mousemove",j)}}),[j]),Object(r.useEffect)((function(){h(s.label)}),[s.label]),c.a.createElement(Ce.Group,{ref:function(e){e&&(C.current=e)},visible:u,onMouseDown:function(e){n===v.None&&(a(o),e.cancelBubble=!0)}},c.a.createElement(Ce.Line,{points:[E.x1,E.y1,E.x2,E.y1,E.x2,E.y2,E.x1,E.y2,E.x1,E.y1],stroke:"red",strokeWidth:O,closed:!0}),c.a.createElement(Ce.Group,{visible:i},c.a.createElement(Ce.Circle,{key:"anchor-0",name:"anchor-0",x:E.x1,y:E.y1,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x1",yi:"y1"}),onDragEnd:S,onMouseEnter:function(){n!==v.Creating&&g(b.nwseResize)},onMouseLeave:function(){g()}}),c.a.createElement(Ce.Circle,{key:"anchor-1",name:"anchor-1",x:E.x2,y:E.y1,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x2",yi:"y1"}),onDragEnd:S,onMouseEnter:function(){n!==v.Creating&&g(b.neswResize)},onMouseLeave:function(){g()}}),c.a.createElement(Ce.Circle,{key:"anchor-2",name:"anchor-2",x:E.x2,y:E.y2,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x2",yi:"y2"}),onDragEnd:S,onMouseEnter:function(){n!==v.Creating&&g(b.nwseResize)},onMouseLeave:function(){g()}}),c.a.createElement(Ce.Circle,{key:"anchor-3",name:"anchor-3",x:E.x1,y:E.y2,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x1",yi:"y2"}),onDragEnd:S,onMouseEnter:function(){n!==v.Creating&&g(b.neswResize)},onMouseLeave:function(){g()}})))},we=function(e){var t=e.scale,n=e.vertices,a=e.color;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce.Line,{ref:function(e){e&&e.cache()},points:[n.x1,n.y1,n.x2,n.y1,n.x2,n.y2,n.x1,n.y2,n.x1,n.y1],stroke:a,strokeWidth:1/t,closed:!0}),c.a.createElement(Ce.Circle,{x:n.x1,y:n.y1,radius:3/t,fill:a}),c.a.createElement(Ce.Circle,{x:n.x2,y:n.y1,radius:3/t,fill:a}),c.a.createElement(Ce.Circle,{x:n.x2,y:n.y2,radius:3/t,fill:a}),c.a.createElement(Ce.Circle,{x:n.x1,y:n.y2,radius:3/t,fill:a}))},Re=Object(r.memo)((function(e){var t,n,a=e.visible,i=e.imageSize,o=e.label,l=e.changeCursorState,u=e.scale,s=e.setShowOuterRemoveButton,d=e.removeBox,m=Object(r.useState)("#F9526B"),g=Object(B.a)(m,2),f=g[0],p=g[1],E=Object(r.useState)(1.5/u),h=Object(B.a)(E,2),v=h[0],y=h[1];return o.x1<0||o.x2>i.width/u||o.y1<0||o.y2>i.height/u?(t=0,n=-60):o.x1>30/u||o.x2<(i.width-25)/u?(t=o.x1>30/u?o.x1-20/u:o.x2+25/u,n=o.y1>12/u?o.y1-10/u:o.y1+12/u):(t=12/u,n=o.y1>20/u?o.y1-20/u:-60),s(-60===n),Object(r.useEffect)((function(){y(1.5/u)}),[u]),c.a.createElement(Ce.Group,{visible:a,x:t,y:n,onMouseEnter:function(){l(b.pointer),p("#E73550"),y(3/u)},onMouseLeave:function(){l(),p("#F9526B"),y(1.5/u)},onClick:function(e){d(),e.cancelBubble=!0}},c.a.createElement(Ce.Rect,{x:-5/u,y:-5/u,width:10/u,height:10/u}),c.a.createElement(Ce.Line,{points:[-5/u,-5/u,5/u,5/u],stroke:f,strokeWidth:v}),c.a.createElement(Ce.Line,{points:[5/u,-5/u,-5/u,5/u],stroke:f,strokeWidth:v}))})),ke={width:800,height:600},Le=function(e){var t=e.url,n=void 0===t?"":t,a=e.labelingType,i=e.annotations,o=Object(l.b)(),u=Object(r.useCallback)(je(ke),[ke]),s=Object(r.useState)(ke),d=Object(B.a)(s,2),m=d[0],g=d[1],f=Object(r.useMemo)((function(){return a===y.SingleAnnotation&&1===i.length}),[a,i]),p=Object(r.useState)(b.default),E=Object(B.a)(p,2),h=E[0],O=E[1],C=Ie(n,"anonymous"),S=Object(B.a)(C,3),I=S[0],j=S[1],T=S[2],x=Object(r.useState)(null),A=Object(B.a)(x,2),_=A[0],w=A[1],R=Object(r.useState)(v.None),k=Object(B.a)(R,2),L=k[0],N=k[1],P=Object(r.useState)(!1),M=Object(B.a)(P,2),D=M[0],U=M[1],G=Object(r.useState)(!1),z=Object(B.a)(G,2),J=z[0],V=z[1],H=Object(r.useRef)(1),q=Object(r.useCallback)((function(e){O(e||(f?b.default:b.crosshair))}),[f]),Y=Object(r.useCallback)((function(){o(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"REMOVE_ANNOTATION",payload:{index:e}}}(_)),N(v.None),U(!1)}),[o,_,N,U]),X=function(e){w(e),N(v.Selecting)};return Object(r.useEffect)((function(){f?(q(),w(0)):q()}),[f,q]),Object(r.useEffect)((function(){L!==v.None||f||w(null)}),[L,f]),Object(r.useEffect)((function(){var e=u(T),t=Object(B.a)(e,2),n=t[0],a=t[1];g(n),H.current=a}),[T,u]),"loading"===j||0===m.height&&0===m.width?c.a.createElement(F.a,{align:"center",color:"red"},"Loading..."):c.a.createElement("div",{style:{margin:"0.2em"}},0!==i.length&&D&&!J&&L!==v.Creating?c.a.createElement(Q.a,{iconOnly:!0,text:!0,styles:{color:"#F9526B",":hover":{color:"#E73550"}},content:c.a.createElement(W.CloseIcon,{size:"large"}),onClick:Y}):c.a.createElement("div",{style:{height:"2em"}}),c.a.createElement(Ce.Stage,{width:m.width,height:m.height,scale:{x:H.current,y:H.current},style:{cursor:h}},c.a.createElement(Ce.Layer,{onMouseDown:function(e){var t;f||L===v.Creating||(o((t={x:e.evt.offsetX/H.current,y:e.evt.offsetY/H.current},{type:"CREATE_ANNOTATION",payload:{annotation:Ae.createWithPoint(t,"")}})),w(i.length-1),N(v.Creating))},onMouseUp:function(e){var t;L===v.Creating&&(o((t={x:e.evt.offsetX/H.current,y:e.evt.offsetY/H.current},{type:"UPDATE_CREATING_ANNOTATION",payload:{updater:function(e){return Ae.add(t,e)}}})),i.length-1===_?N(v.Selecting):N(v.None))},onDragStart:function(){V(!0)},onDragEnd:function(){V(!1)}},c.a.createElement(Ce.Image,{image:I}),i.map((function(e,t){return c.a.createElement(Ce.Group,{key:t},c.a.createElement(Re,{imageSize:m,visible:!J&&L!==v.Creating&&t===_,label:e.label,scale:H.current,changeCursorState:q,setShowOuterRemoveButton:U,removeBox:Y}),c.a.createElement(_e,{workState:L,onSelect:X,annotation:e,scale:H.current,annotationIndex:t,selected:t===_,dispatch:o,changeCursorState:q}))})))))},Ne=function(e){return console.error(e),{type:"REQUEST_LABEL_IMAGE_FAILURE"}},Pe=function(){return function(e){return X()("/api/images/").then((function(t){var n=t.data;e(function(e){return{type:"GET_LABEL_IMAGE_SUCCESS",payload:e}}(n))})).catch((function(t){e(Ne(t))}))}},Me=function(e){return function(t){return X()("/api/images/",{method:"POST",data:e}).then((function(e){var n=e.data;t({type:"POST_LABEL_IMAGE_SUCCESS",payload:n})})).catch((function(e){t(Ne(e))}))}},De=function(e,t){return function(n){var a="/api/images/".concat(e,"/");return X()({url:a,method:"PATCH",data:{labels:JSON.stringify(t.map((function(e){return e.label})))}}).then((function(e){var t=e.data;console.info("Save successfully"),n(Ue(t.id,t.labels))})).catch((function(e){n(Ne(e))}))}},Ue=function(e,t){return{type:"UPDATE_LABEL_IMAGE_ANNOTATION",payload:{id:e,labels:t}}},Fe=function(e){return parseInt(e.split("/")[5],10)},Ge=function(e,t){var n=t.partId,a=t.isRelabel,r=void 0!==a&&a;return void 0===n?e:e.filter((function(e){return Fe(e.part)===n&&e.is_relabel===r}))},ze=function(e){if(0===e.length)return!1;var t=e[e.length-1].label;return t.x1===t.x2&&t.y1===t.y2},Je=function(e){var t,n,a=e.labelingType,i=e.imageIndex,o=e.closeDialog,u=e.partId,s=e.isRelabel,d=Object(l.b)(),m=Object(r.useState)(i),g=Object(B.a)(m,2),f=g[0],p=g[1],E=Object(l.c)((function(e){return{images:e.images,annotations:e.labelingPageState.annotations}})),b=E.images,v=E.annotations,y=Ge(b,{partId:u,isRelabel:s}),O=null===(t=y[f])||void 0===t?void 0:t.image,C=null===(n=y[f])||void 0===n?void 0:n.id;return Object(r.useEffect)((function(){return"number"===typeof C&&d(function(e){return function(t,n){var a=n().images.find((function(t){return t.id===e})).labels;if(null===a)t(xe([]));else{var r=JSON.parse(a).map((function(e){return{label:e,attribute:"",annotationState:h.Finish}}));t(xe(r))}}}(C)),function(){d({type:"RESET_ANNOTATION"})}}),[d,C]),c.a.createElement(U.a,{column:!0,hAlign:"center"},c.a.createElement(F.a,{size:"larger",weight:"semibold"},"DRAW A RECTANGLE AROUND THE PART"),c.a.createElement(U.a,{vAlign:"center"},!s&&c.a.createElement(Q.a,{text:!0,disabled:0===f||ze(v),icon:c.a.createElement(W.ChevronStartIcon,{size:"larger"}),onClick:function(){d(De(y[f].id,v)),p((function(e){return(e-1+y.length)%y.length}))}}),c.a.createElement(Le,{url:null!==O&&void 0!==O?O:"/icons/Play.png",annotations:v,labelingType:a}),!s&&c.a.createElement(Q.a,{text:!0,disabled:f===y.length-1||ze(v),icon:c.a.createElement(W.ChevronEndIcon,{size:"larger"}),onClick:function(){d(De(y[f].id,v)),p((function(e){return(e+1)%y.length}))}})),c.a.createElement(U.a,{gap:"gap.medium"},c.a.createElement(Q.a,{primary:!0,content:"Save",disabled:ze(v),onClick:function(){d(De(y[f].id,v)),o()}}),c.a.createElement(Q.a,{content:"Cancel",onClick:function(){o()}})))},Be=Object(r.memo)((function(e){var t=e.trigger,n=e.imageIndex,a=e.partId,i=e.isRelabel,o=Object(r.useState)(!1),l=Object(B.a)(o,2),u=l[0],s=l[1];return c.a.createElement(H.a,{trigger:t,styles:{width:"80%"},open:u,onOpen:function(){return s(!0)},content:c.a.createElement(Je,{closeDialog:function(){return s(!1)},labelingType:y.SingleAnnotation,imageIndex:n,partId:a,isRelabel:i})})})),Ve=function(e){var t=e.labelImage,n=e.labelText,a=void 0===n?"":n,i=e.width,o=void 0===i?300:i,l=e.height,u=void 0===l?150:l,s=e.pointerCursor,d=void 0!==s&&s,m=e.onClick,g=Ie(t.image,"anonymous"),f=Object(B.a)(g,3),p=f[0],E=(f[1],f[2]),b=Object(r.useState)({width:o,height:u}),v=Object(B.a)(b,2),y=v[0],O=v[1],C=Object(r.useCallback)(je({width:o,height:u}),[o,u]),S=Object(r.useRef)(1),I=Object(r.useMemo)((function(){return(null===t||void 0===t?void 0:t.labels)?JSON.parse(t.labels).map((function(e){return{label:e,attribute:"",annotationState:h.Finish}})):[]}),[t]);return Object(r.useEffect)((function(){var e=C(E),t=Object(B.a)(e,2),n=t[0],a=t[1];O(n),S.current=a}),[E,C]),c.a.createElement("div",{onClick:m,style:{cursor:d?"pointer":"default"}},c.a.createElement(U.a,{column:!0},c.a.createElement(Ce.Stage,{width:y.width,height:y.height,scale:{x:S.current,y:S.current}},c.a.createElement(Ce.FastLayer,null,c.a.createElement(Ce.Image,{image:p}),I.map((function(e,t){return c.a.createElement(we,{key:t,scale:S.current,vertices:e.label,color:"red"})})))),c.a.createElement(F.a,{align:"center"},a)))},He=n(211),Qe=n.n(He),We=n(359),qe=c.a.memo((function(e){var t=e.rtsp,n=void 0===t?null:t,a=e.partId,i=e.canCapture,o=e.onVideoStart,u=e.onVideoPause,s=Object(r.useState)(""),d=Object(B.a)(s,2),m=d[0],g=d[1],f=Object(l.b)(),p=function(){g(""),fetch("/api/streams/".concat(m,"/disconnect")).then((function(e){return e.json()})).then((function(e){return console.log(e),null})).catch((function(e){console.error(e)})),u&&u()};Object(r.useEffect)((function(){return window.addEventListener("beforeunload",p),function(){window.removeEventListener("beforeunload",p)}}));var E=m?"/api/streams/".concat(m,"/video_feed"):"";return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{width:"100%",height:"600px",backgroundColor:"black"}},E?c.a.createElement(G.a,{src:E,styles:{width:"100%",height:"100%",objectFit:"contain"}}):null),c.a.createElement(Q.a.Group,{styles:{alignSelf:"center"},buttons:[{key:"start",icon:c.a.createElement(W.PlayIcon,null),iconOnly:!0,onClick:function(){var e="/api/streams/connect/?part_id=".concat(a,"&rtsp=").concat(n);i||(e+="&inference=1"),fetch(e).then((function(e){return e.json()})).then((function(e){return"ok"===(null===e||void 0===e?void 0:e.status)&&g(e.stream_id),null})).catch((function(e){console.error(e)})),o&&o()},disabled:null===n},i&&{key:"capture",icon:c.a.createElement(W.CallControlPresentNewIcon,null),iconOnly:!0,onClick:function(){f(function(e){return function(){var t=Object(We.a)(Qe.a.mark((function t(n){return Qe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch("/api/streams/".concat(e,"/capture")).then((function(e){return e.json()})).then((function(e){return"ok"===e.status&&(n({type:"ADD_CAPTURED_IMAGE",payload:{newCapturedImage:e.image}}),n(Pe())),null})).catch((function(e){console.error(e)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(m))},disabled:!m},{key:"stop",icon:c.a.createElement(W.PauseThickIcon,null),iconOnly:!0,onClick:p,disabled:!m}]}))})),Ye=function(e){return Array.isArray(e)?e.map((function(e){return{header:e.name,content:{key:e.id}}})):e?{header:e.name,content:{key:e.id}}:null},Xe=function(e){var t=e.partId,n=Object(r.useState)(null),a=Object(B.a)(n,2),i=a[0],o=a[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ke,{selectedCamera:i,setSelectedCamera:o}),c.a.createElement(qe,{rtsp:null===i||void 0===i?void 0:i.rtsp,partId:t,canCapture:!0}),c.a.createElement($e,{partId:t}))},Ke=function(e){var t=e.selectedCamera,n=e.setSelectedCamera,a=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.cameras}));return Object(r.useEffect)((function(){e($())}),[e]),t}(),i=a.map((function(e){return{header:e.name,content:{key:e.id}}}));return c.a.createElement(U.a,{gap:"gap.small",vAlign:"center"},c.a.createElement(F.a,null,"Select Camera"),c.a.createElement(Oe.a,{items:i,onChange:function(e,t){if(null===t.value)n((function(e){return e}));else{var r=t.value.content.key,c=a.find((function(e){return e.id===r}));c&&n(c)}},value:Ye(t)}),c.a.createElement(P.b,{to:"/addCamera"},"Add Camera"))},$e=function(e){var t=e.partId,n=Object(l.b)(),a=Object(l.c)((function(e){return e.images})).filter((function(e){return!e.is_relabel})),i=Ge(a,{partId:t,isRelabel:!1}),o=i.filter((function(e){return e.labels})).length>=15;Object(r.useEffect)((function(){n(Pe())}),[n]);var u=i.length;return c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,null,"Total: ",u),!o&&c.a.createElement(F.a,{error:!0},"*Please capture and label more then 15 images"),c.a.createElement(U.a,{styles:{overflow:"scroll",border:"1px solid grey",height:"150px",borderColor:o?"":"red"},gap:"gap.small",vAlign:"center"},i.map((function(e,n){return c.a.createElement("div",{key:e.id},c.a.createElement("span",null,n+1),c.a.createElement(Be,{key:n,imageIndex:n,partId:t,trigger:c.a.createElement(Ve,{labelImage:e,pointerCursor:!0,width:200,height:150}),isRelabel:!1}))}))),c.a.createElement(D.a,{when:u<15,message:"The count of images is less than 15, which may cause error when configure part identification. Sure you want to leave?"}))},Ze=function(e){var t=e.partId,n=Object(l.b)(),a=Object(l.c)((function(e){return e.images})),i=Ge(a,{partId:t,isRelabel:!1}),o=i.filter((function(e){return e.labels})).length>=15;return Object(r.useEffect)((function(){n(Pe())}),[n]),c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{type:"file",onChange:function(e){for(var a=0;a<e.target.files.length;a++){var r=new FormData;r.append("image",e.target.files[a]),r.append("part","/api/parts/".concat(t,"/")),n(Me(r))}},accept:"image/*",multiple:!0}),c.a.createElement(et,{capturedImages:i,isValid:o,partId:t}))},et=function(e){var t=e.capturedImages,n=e.isValid,a=e.partId;return c.a.createElement(c.a.Fragment,null,!n&&c.a.createElement(F.a,{error:!0},"*Please capture and label more then 15 images"),c.a.createElement(V.a,{columns:"2",styles:{border:"1px solid grey",height:"100%",gridGap:"10px",padding:"10px",borderColor:n?"":"red",justifyItems:"center",alignItems:"center"}},t.map((function(e,t){return c.a.createElement(Be,{key:t,imageIndex:t,trigger:c.a.createElement(Ve,{labelImage:e,pointerCursor:!0,width:300,height:225}),partId:a,isRelabel:!1})}))))},tt=function(){var e=de().get("partId");return c.a.createElement(V.a,{columns:"repeat(12, 1fr)",styles:{gridColumnGap:"20px",height:"100%"}},c.a.createElement(nt,{partId:e}),c.a.createElement(at,{partId:e}))},nt=function(e){var t=e.partId,n=Object(r.useState)(""),a=Object(B.a)(n,2),i=a[0],o=a[1],l=Object(r.useState)(""),u=Object(B.a)(l,2),s=u[0],d=u[1],m=Object(r.useState)(""),g=Object(B.a)(m,2),f=g[0],p=g[1],E=Object(D.h)();Object(r.useEffect)((function(){t&&X.a.get("/api/parts/".concat(t,"/")).then((function(e){var t=e.data;o(t.name),d(t.description)})).catch((function(e){console.error(e)}))}),[t]);return c.a.createElement(U.a,{column:!0,space:"around",styles:{gridColumn:"1 / span 4"}},c.a.createElement(q.a,{placeholder:"Enter Part Name...",fluid:!0,styles:{fontSize:"2em"},value:i,onChange:function(e,t){o(t.value)}}),c.a.createElement(ve.a,{placeholder:"Enter Description...",design:{height:"80%"},value:s,onChange:function(e,t){d(t.value)}}),c.a.createElement(U.a,{space:"around"},c.a.createElement(Q.a,{content:"Save",primary:!0,onClick:function(){var e=![void 0,null].includes(t),n=e?"/api/parts/".concat(t,"/"):"/api/parts/";X()({method:e?"PUT":"POST",url:n,data:{name:i,description:s}}).then((function(e){var t=e.data;E.push("/parts/detail/capturePhotos?partId=".concat(t.id))})).catch((function(e){p(JSON.stringify(e.response.data))}))},disabled:!i||!s}),c.a.createElement(Q.a,{content:"Cancel"})),!!f&&c.a.createElement(ne.a,{danger:!0,content:f,dismissible:!0}))},at=function(e){var t=e.partId;return c.a.createElement(U.a,{column:!0,gap:"gap.small",styles:{gridColumn:"5 / span 8"}},t?c.a.createElement(rt,{partId:t}):null,c.a.createElement(D.e,null,c.a.createElement(D.c,{path:"/parts/detail/capturePhotos"},c.a.createElement(Xe,{partId:parseInt(t,10)})),c.a.createElement(D.c,{path:"/parts/detail/uploadPhotos"},c.a.createElement(Ze,{partId:parseInt(t,10)}))))},rt=function(e){var t=e.partId,n=[{key:"uploadPhotos",as:P.b,to:"/parts/detail/uploadPhotos?partId=".concat(t),content:"Upload Photos"},{key:"capturePhotos",as:P.b,to:"/parts/detail/capturePhotos?partId=".concat(t),content:"Capture Photo"}],a=Object(D.i)().pathname,r=n.findIndex((function(e){return e.to.split("?")[0]===a}));return c.a.createElement(ye.a,{items:n,activeIndex:r,pointing:!0,primary:!0})},ct=function(e){return console.error(e),{type:"REQUEST_LOCATION_FAILURE"}},it=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.locations}));return Object(r.useEffect)((function(){e((function(e){return fetch("/api/locations/").then((function(e){return e.json()})).then((function(t){e(function(e){return{type:"GET_LOCATION_SUCCESS",payload:e}}(t))})).catch((function(t){e(ct(t))}))}))}),[e]),c.a.createElement(U.a,{column:!0,gap:"gap.large",padding:"padding.medium",styles:{height:"100%"}},c.a.createElement(V.a,{columns:"8",styles:{height:"75%"}},t.map((function(e,t){return c.a.createElement(z,{key:t,to:"/locations/detail?name=".concat(e.name),defaultSrc:"/icons/defaultLocation.png",width:"100px",height:"100px",label:e.name})}))),c.a.createElement(U.a,{hAlign:"end"},c.a.createElement(P.b,{to:"/locations/register"},c.a.createElement(Q.a,{primary:!0,fluid:!0,circular:!0,content:c.a.createElement(W.AddIcon,{size:"largest",circular:!0}),style:{width:"6em",height:"6em"}}))))},ot=n(230),lt=function(){var e=Object(l.b)(),t=Object(D.h)(),n=Object(r.useState)(""),a=Object(B.a)(n,2),i=a[0],o=a[1],u=Object(r.useState)(""),s=Object(B.a)(u,2),d=s[0],m=s[1],g=Object(r.useState)(""),f=Object(B.a)(g,2),p=f[0],E=f[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,{size:"larger",weight:"semibold"},"Register Location"),c.a.createElement(ot.a,{color:"black"}),c.a.createElement(V.a,{columns:"15% 3fr 2fr",styles:{height:"60%"}},c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement(z,{defaultSrc:"/icons/defaultLocation.png",width:"100px",height:"100px"}),c.a.createElement(F.a,null,"Coordinates:"),c.a.createElement(F.a,null,"Description:")),c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement(q.a,{styles:{paddingTop:"10px",minHeight:"100px"},placeholder:"Location Name",value:i,onChange:function(e,t){return o(t.value)}}),c.a.createElement(q.a,{value:d,onChange:function(e,t){return m(t.value)}}),c.a.createElement(ve.a,{styles:{height:"60%"},value:p,onChange:function(e,t){return E(t.value)}}))),c.a.createElement(U.a,{gap:"gap.medium",padding:"padding.medium"},c.a.createElement(Q.a,{primary:!0,disabled:[i,d,p].includes(""),onClick:function(){var n;e((n={name:i,coordinates:d,description:p},function(e){return fetch("/api/locations/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(t){e(function(e){return{type:"POST_LOCATION_SUCCESS",payload:e}}(t))})).catch((function(t){e(ct(t))}))})),t.push("/locations")},content:"Save"}),c.a.createElement(Q.a,{content:"Cancel",onClick:function(){t.push("/locations")}})))},ut=function(){var e=de().get("name"),t=Object(l.c)((function(t){return t.locations.find((function(t){return t.name===e}))}));return c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,{size:"larger",weight:"semibold"},"Details"),c.a.createElement(ot.a,{color:"black"}),c.a.createElement(V.a,{columns:"15% 3fr 2fr",styles:{height:"60%"}},c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement(z,{defaultSrc:"/icons/defaultLocation.png",width:"100px",height:"100px"}),c.a.createElement(F.a,null,"Coordinates:"),c.a.createElement(F.a,null,"Description:")),c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement(F.a,{styles:{paddingTop:"10px",minHeight:"100px"}},t.name),c.a.createElement(F.a,null,t.coordinates),c.a.createElement(F.a,{styles:{height:"60%"}},t.description))))},st=n(493),dt=n(241),mt=n(258),gt=n(360),ft=(n(936),n(937),!1),pt=function(e){var t,n=e.confidenceLevel,a=e.labelImage,r=e.imageIndex,i=e.judgedImages,o=e.setJudgedImages,l=e.partId;return t=i.correct.indexOf(a.id)>=0?1:i.incorrect.indexOf(a.id)>=0?0:null,c.a.createElement(U.a,{hAlign:"center",padding:"padding.medium"},c.a.createElement("div",{style:{margin:"0.2em"}},c.a.createElement(Ve,{labelImage:a,width:100,height:100})),c.a.createElement(U.a,{column:!0,gap:"gap.smaller",styles:{width:"30%"}},c.a.createElement(F.a,{truncated:!0},"Confidence Level: ",n,"%"),c.a.createElement(U.a,{column:!0},c.a.createElement(dt.a,{checkedValue:t,onCheckedValueChange:function(e,t){o((function(e){if(1===t.value){var n=e.incorrect.indexOf(a.id),r=e.correct.indexOf(a.id);n>=0&&e.incorrect.splice(n,1),-1===r&&e.correct.push(a.id)}if(0===t.value){var c=e.correct.indexOf(a.id),i=e.incorrect.indexOf(a.id);c>=0&&e.correct.splice(c,1),-1===i&&e.incorrect.push(a.id)}return Object(I.a)({},e)}))},items:[{key:"1",label:"Yes",value:1},{key:"0",label:"No",value:0}]})),c.a.createElement(Be,{imageIndex:r,isRelabel:!0,partId:l,trigger:c.a.createElement(Q.a,{primary:!0,content:"Identify",disabled:!t})})))},Et=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return{projectData:e.project.data,images:e.images}})),n=t.projectData,a=t.images,i=se(),o=Object(r.useMemo)((function(){return 0===i.length||0===n.parts.length?[]:n.parts.map((function(e){var t=i.find((function(t){return t.id===e}));return{header:t.name,content:{key:t.id}}}))}),[i,n]),u=Object(r.useState)(null),s=Object(B.a)(u,2),d=s[0],m=s[1],g=Object(r.useState)([n.accuracyRangeMin,n.accuracyRangeMax]),f=Object(B.a)(g,2),p=f[0],E=f[1],h=Object(r.useState)(!1),b=Object(B.a)(h,2),v=b[0],y=b[1],O=Object(r.useState)({correct:[],incorrect:[]}),C=Object(B.a)(O,2),S=C[0],j=C[1],T=Object(r.useMemo)((function(){var e=Ge(a,{partId:d,isRelabel:!0}).map((function(e){return Object(I.a)({},e,{confidenceLevel:(1e3*e.confidence|0)/10})})).filter((function(e){return e.confidenceLevel>=p[0]&&e.confidenceLevel<=p[1]}));return ft&&(v?e.sort((function(e,t){return e.confidenceLevel-t.confidenceLevel})):e.sort((function(e,t){return t.confidenceLevel-e.confidenceLevel}))),e}),[p,v,a,d]);Object(r.useEffect)((function(){e(oe()),e(Pe())}),[e]);var x=o.find((function(e){return e.content.key===d}));return c.a.createElement("div",null,c.a.createElement(F.a,{size:"larger",weight:"semibold"},"Manual Identification"),c.a.createElement(ot.a,{color:"black"}),c.a.createElement(U.a,{column:!0,gap:"gap.medium",space:"between",styles:{height:"75vh",padding:"1em"}},c.a.createElement(V.a,{columns:"3",styles:{columnGap:"1em",justifyItems:"center"}},c.a.createElement(U.a,{vAlign:"center",gap:"gap.smaller"},c.a.createElement(F.a,{truncated:!0},"Select Part:"),c.a.createElement(Oe.a,{items:o,onChange:function(e,t){var n=t.value;if(null===n)m((function(e){return e}));else{var a=n.content.key;m(a)}},value:x})),c.a.createElement(U.a,{vAlign:"center",gap:"gap.smaller",styles:{width:"80%"}},c.a.createElement(F.a,null,"Confidence Level:"),c.a.createElement("div",{style:{width:"70%"}},c.a.createElement(gt.b,{value:p,allowCross:!1,onChange:function(e){return E(e)},handle:function(e){var t=e.value,n=e.dragging,a=e.index,r=Object(st.a)(e,["value","dragging","index"]);return c.a.createElement(mt.a,{prefixCls:"rc-slider-tooltip",overlay:"".concat(t,"%"),visible:n,placement:"top",key:a},c.a.createElement(gt.a,Object.assign({value:t},r)))}}))),c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{truncated:!0},"Sort:"),c.a.createElement(Q.a,{icon:v?c.a.createElement(W.ArrowDownIcon,null):c.a.createElement(W.ArrowUpIcon,null),styles:{color:ft?"#0094d8":"grey"},text:!0,iconOnly:!0,onClick:function(){ft=!0,y((function(e){return!e}))}}))),c.a.createElement(V.a,{columns:"2",styles:{width:"100%",height:"80%",borderStyle:"solid",overflow:"scroll",borderWidth:"1px"}},T.map((function(e,t){return c.a.createElement(pt,{key:t,confidenceLevel:e.confidenceLevel,imageIndex:t,labelImage:e,judgedImages:S,setJudgedImages:j,partId:d})}))),c.a.createElement(Q.a,{content:"Update",styles:{width:"15%"},primary:!0,disabled:0===S.correct.length&&0===S.incorrect.length,onClick:function(){X()({method:"POST",url:"/api/relabel/update",data:S}).then((function(){e(Pe()),j({correct:[],incorrect:[]})})).catch((function(e){console.error(e)}))}})))},ht=function(){var e=Object(r.useState)([]),t=Object(B.a)(e,2),n=t[0],a=t[1],i=X.a.get("/api/parts/"),o=X.a.get("/api/images/");return Object(r.useEffect)((function(){X.a.all([i,o]).then(X.a.spread((function(){var e=arguments.length<=0?void 0:arguments[0],t=e.data,n=arguments.length<=1?void 0:arguments[1],r=n.data;a(t.map((function(e){var t;return Object(I.a)({},e,{images:null===(t=r.find((function(t){return Fe(t.part)===e.id})))||void 0===t?void 0:t.image})})))}))).catch((function(e){return console.error(e)}))}),[]),c.a.createElement("div",{style:{position:"relative",height:"100%"}},c.a.createElement(U.a,{gap:"gap.large",wrap:!0},n.map((function(e){return c.a.createElement(bt,{key:e.id,src:e.images,id:e.id,name:e.name})}))),c.a.createElement(Q.a,{primary:!0,fluid:!0,circular:!0,content:c.a.createElement(W.AddIcon,{size:"largest",circular:!0}),style:{width:100,height:100,position:"fixed",right:"100px",bottom:"100px"},as:P.b,to:"/parts/detail"}))},bt=function(e){var t=e.src,n=e.id,a=e.name;return c.a.createElement(U.a,{column:!0,hAlign:"center",gap:"gap.large",as:P.b,to:"/parts/detail/capturePhotos?partId=".concat(n)},c.a.createElement("div",{style:{width:"250px",height:"250px"}},c.a.createElement(G.a,{src:t,styles:{width:"100%",height:"100%",objectFit:"cover"}})),c.a.createElement(F.a,{size:"larger"},a))},vt=n(172),yt=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.project})),n=t.isLoading,a=t.error,i=t.data,o=i.id,u=i.camera,s=i.location,d=i.parts,m=i.needRetraining,g=i.accuracyRangeMin,f=i.accuracyRangeMax,p=i.maxImages,E=Ot("cameras"),h=Object(B.a)(E,4),b=h[0],v=h[1],y=h[2],O=h[3],C=Ot("parts",!0),S=Object(B.a)(C,4),j=S[0],T=S[1],x=S[2],A=S[3],_=Ot("locations"),w=Object(B.a)(_,4),R=w[0],k=w[1],L=w[2],N=w[3],M=Object(D.h)(),G=Object(r.useState)(!1),z=Object(B.a)(G,2),J=z[0],V=z[1];Object(r.useEffect)((function(){b||j||R||e(oe())}),[e,b,R,j]),Object(r.useEffect)((function(){s&&N(s),d.length&&A(d),u&&O(u)}),[u,s,d,O,N,A]);var H=function(t,n){e({type:"UPDATE_PROJECT_DATA",payload:Object(I.a)({},i,Object(Te.a)({},t,n))})};return c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,{size:"larger",weight:"semibold"},"Part Identification"),c.a.createElement(ot.a,{color:"black"}),a&&c.a.createElement(ne.a,{danger:!0,header:"Load Part Identification Error",content:"".concat(a.name,": ").concat(a.message)}),c.a.createElement(U.a,{column:!0,gap:"gap.large",design:{paddingTop:"30px"}},c.a.createElement(Ct,{moduleName:"cameras",to:"/cameras",value:y,setSelectedModuleItem:O,items:v,isMultiple:!1}),c.a.createElement(Ct,{moduleName:"parts",to:"/parts",value:x,setSelectedModuleItem:A,items:T,isMultiple:!0}),c.a.createElement(Ct,{moduleName:"locations",to:"/locations",value:L,setSelectedModuleItem:N,items:k,isMultiple:!1}),c.a.createElement(vt.a,{label:"Set up retraining",checked:m,onChange:function(e,t){var n=t.checked;return H("needRetraining",n)}}),c.a.createElement(F.a,{disabled:!m},"Accuracy Range"),c.a.createElement(F.a,{disabled:!m},"Minimum:"," ",c.a.createElement(q.a,{type:"number",disabled:!m,inline:!0,value:g,onChange:function(e,t){var n=t.value;return H("accuracyRangeMin",n)}}),"%"),c.a.createElement(F.a,{disabled:!m},"Maximum:"," ",c.a.createElement(q.a,{type:"number",disabled:!m,inline:!0,value:f,onChange:function(e,t){var n=t.value;return H("accuracyRangeMax",n)}}),"%"),c.a.createElement(F.a,{disabled:!m},"Maximum Images:"," ",c.a.createElement(q.a,{type:"number",disabled:!m,inline:!0,value:p,onChange:function(e,t){var n=t.value;V(n<15),H("maxImages",n)}}),J&&c.a.createElement(F.a,{error:!0},"Cannot be less than 15")),c.a.createElement(P.b,{to:""},"Advanced Configuration"),c.a.createElement(Q.a,{content:"Configure",primary:!0,onClick:function(){e(function(e,t,n,a){return function(r,c){var i=null===e,o=i?"/api/projects/":"/api/projects/".concat(e,"/");r({type:"POST_PROJECT_REQUEST"});var l=c().project.data;return X()(o,{data:{location:"http://localhost:8000/api/locations/".concat(t.id,"/"),parts:n.map((function(e){return"http://localhost:8000/api/parts/".concat(e.id,"/")})),camera:"http://localhost:8000/api/cameras/".concat(a.id,"/"),download_uri:l.modelUrl,needRetraining:l.needRetraining,accuracyRangeMin:l.accuracyRangeMin,accuracyRangeMax:l.accuracyRangeMax,maxImages:l.maxImages},method:i?"POST":"PUT",headers:{"Content-Type":"application/json"}}).then((function(e){var t=e.data;return r({type:"POST_PROJECT_SUCCESS"}),le(t.id),t.id})).catch((function(e){r({type:"POST_PROJECT_FALIED",error:e})}))}}(o,L,x,y)).then((function(e){"undefined"!==typeof e&&M.push("/cameras/detail?name=".concat(y.name))})).catch((function(e){return e}))},disabled:!y||!L||!x||n,loading:n})))};function Ot(e,t){var n=Object(r.useRef)([]),a=Object(r.useState)([]),c=Object(B.a)(a,2),i=c[0],o=c[1],l=Object(r.useState)(t?[]:null),u=Object(B.a)(l,2),s=u[0],d=u[1],m=Object(r.useState)(!0),g=Object(B.a)(m,2),f=g[0],p=g[1];return Object(r.useEffect)((function(){p(!0),fetch("/api/".concat(e,"/")).then((function(e){return e.json()})).then((function(e){o(e.map((function(e){return{header:e.name,content:{key:e.id}}}))),n.current=e,p(!1)})).catch((function(e){p(!1),console.error(e)}))}),[e]),[f,i,s,Object(r.useCallback)((function(e){if(Array.isArray(e)){var t=e.reduce((function(e,t){var a=n.current.find((function(e){return e.id.toString(10)===t.toString()}));return a&&e.push(a),e}),[]);d(t)}else{var a=n.current.find((function(t){return t.id.toString(10)===e.toString()}));a&&d(a)}}),[])]}var Ct=function(e){var t=e.moduleName,n=e.to,a=e.value,r=e.setSelectedModuleItem,i=e.items,o=e.isMultiple;return c.a.createElement(U.a,{vAlign:"center",gap:"gap.medium"},c.a.createElement(F.a,{styles:{width:"150px"}},"Select ".concat(t)),c.a.createElement(Oe.a,{items:i,onChange:function(e,t){if(null===t.value)r((function(e){return e}));else if(Array.isArray(t.value)){var n=t.value.map((function(e){return e.content.key}));r(n)}else{var a=t.value.content.key;r(a)}},value:Ye(a),multiple:o}),c.a.createElement(P.b,{to:n},"Add ".concat(t)))},St=function(){var e=Object(r.useState)({id:null,key:"",namespace:"",iotHubConnectionString:"",deviceId:"",moduleId:""}),t=Object(B.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)({success:!1,content:""}),o=Object(B.a)(i,2),l=o[0],u=o[1];Object(r.useEffect)((function(){X.a.get("/api/settings/").then((function(e){var t=e.data;t.length>0&&a({id:t[0].id,key:t[0].training_key,namespace:t[0].endpoint,iotHubConnectionString:t[0].iot_hub_connection_string,deviceId:t[0].device_id,moduleId:t[0].module_id})})).catch((function(e){console.error(e)}))}),[]);return c.a.createElement(U.a,{column:!0,gap:"gap.large"},c.a.createElement("h1",null,"Setting"),c.a.createElement(ot.a,{color:"grey"}),c.a.createElement(F.a,{size:"large",weight:"bold"},"Azure Cognitive Services Settings:"," "),c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{size:"large",design:{width:"300px"}},"Namespace:"),c.a.createElement(q.a,{value:n.namespace,onChange:function(e,t){var n=t.value;return a((function(e){return Object(I.a)({},e,{namespace:n})}))}})),c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{size:"large",design:{width:"300px"}},"Key:"),c.a.createElement(q.a,{value:n.key,onChange:function(e,t){var n=t.value;return a((function(e){return Object(I.a)({},e,{key:n})}))}})),c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{size:"large",design:{width:"300px"}},"Iot Hub Connection String:"),c.a.createElement(q.a,{value:n.iotHubConnectionString,onChange:function(e,t){var n=t.value;return a((function(e){return Object(I.a)({},e,{iotHubConnectionString:n})}))}})),c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{size:"large",design:{width:"300px"}},"Device ID:"),c.a.createElement(q.a,{value:n.deviceId,onChange:function(e,t){var n=t.value;return a((function(e){return Object(I.a)({},e,{deviceId:n})}))}})),c.a.createElement(U.a,{vAlign:"center"},c.a.createElement(F.a,{size:"large",design:{width:"300px"}},"Module ID:"),c.a.createElement(q.a,{value:n.moduleId,onChange:function(e,t){var n=t.value;return a((function(e){return Object(I.a)({},e,{moduleId:n})}))}})),c.a.createElement(U.a,{gap:"gap.large"},c.a.createElement(Q.a,{primary:!0,onClick:function(){var e=null===n.id,t=e?"/api/settings/":"/api/settings/".concat(n.id,"/");X()(t,{data:{training_key:n.key,endpoint:n.namespace,iot_hub_connection_string:n.iotHubConnectionString,device_id:n.deviceId,module_id:n.moduleId},method:e?"POST":"PUT"}).then((function(){u({success:!0,content:"Save Setting Successfully"})})).catch((function(e){u({success:!1,content:"Fail to save settings: /n ".concat(e.toString())})}))},disabled:Object.values(n).some((function(e){return!e}))},"Save"),c.a.createElement(Q.a,{primary:!0,as:P.b,to:"/"},"Cancel")),l.content?c.a.createElement(ne.a,{success:l.success,danger:!l.success,content:l.content,dismissible:!0}):null)},It=function(){return c.a.createElement(D.e,null,c.a.createElement(D.c,{path:"/manual",component:Et}),c.a.createElement(D.c,{path:"/locations/register",component:lt}),c.a.createElement(D.c,{path:"/locations/detail",component:ut}),c.a.createElement(D.c,{path:"/locations",component:it}),c.a.createElement(D.c,{path:"/cameras/detail",component:be}),c.a.createElement(D.c,{path:"/cameras",component:Z}),c.a.createElement(D.c,{path:"/parts/detail",component:tt}),c.a.createElement(D.c,{path:"/parts",component:ht}),c.a.createElement(D.c,{path:"/partIdentification",component:yt}),c.a.createElement(D.c,{path:"/setting",component:St}),c.a.createElement(D.c,{path:"/",component:J}))},jt=n(235),Tt=function(){var e=Object(D.i)().pathname;if("/"===e)return c.a.createElement(F.a,{color:"black"},"Home");var t=e.split("/").slice(1).reduce((function(e,t){var n=function(e){switch(e){case"cameras":return"Camera";case"parts":return"Part";case"locations":return"Location";case"register":return"Register";case"label":return"Label";case"manual":return"Identify Manually";case"detail":return"Details";case"partIdentification":return"Job Configuration";case"capturePhotos":case"uploadPhotos":return null;default:return"string"===typeof e?"Details":null}}(t);if(!n)return e;var a="".concat(e.path,"/").concat(t);return{pathTitles:[].concat(Object(S.a)(e.pathTitles),[{title:n,to:a}]),path:a}}),{pathTitles:[],path:""}).pathTitles;return c.a.createElement(U.a,{gap:"gap.smaller"},c.a.createElement(P.b,{to:"/",style:{color:"#0094d8",textDecoration:"none"}},c.a.createElement(F.a,null,"Home")),t.map((function(e,t,n){return c.a.createElement(r.Fragment,{key:t},c.a.createElement(F.a,{color:"black"},">"),t===n.length-1?c.a.createElement(F.a,{color:"black"},e.title):c.a.createElement(P.b,{to:"".concat(e.to),style:{color:"#0094d8",textDecoration:"none"}},c.a.createElement(F.a,null,e.title)))})))},xt=function(e){var t=e.children;return c.a.createElement(V.a,{columns:"60px auto",rows:"50px auto",design:{height:"100vh"},styles:{justifyContent:"stretch"}},c.a.createElement(At,null),c.a.createElement(_t,{styles:{gridColumn:"1 / span 1",gridRow:"2 / span 1",boxShadow:"1px 0px 10px 0px rgba(0,0,0,0.75)",zIndex:1}}),c.a.createElement(jt.a,{styles:{gridColumn:"span 1",padding:"30px"}},c.a.createElement(Tt,null),t))},At=function(){return c.a.createElement(U.a,{space:"between",vAlign:"center",padding:"padding.medium",styles:{backgroundColor:"#0094d8",gridColumn:"1 / span 2",boxShadow:"0px 1px 10px 0px rgba(0,0,0,0.75)",zIndex:2,fontSize:"20px",padding:"0.5em 1em"}},c.a.createElement(U.a,{gap:"gap.large",vAlign:"center"},c.a.createElement(W.MenuIcon,{size:"large",styles:{color:"white"}}),c.a.createElement(P.c,{to:"/",style:{textDecoration:"none"}},c.a.createElement(F.a,{color:"white"},"Vision on Edge"))),c.a.createElement(U.a,{vAlign:"center",hAlign:"end",gap:"gap.medium",styles:{height:"100%"}},c.a.createElement(P.b,{to:"/setting",style:{height:"100%"}},c.a.createElement(G.a,{styles:{height:"100%"},src:"/icons/setting.png"})),c.a.createElement(F.a,{color:"white"},"User")))},_t=function(e){var t=e.styles;return c.a.createElement(jt.a,{color:"grey",inverted:!0,styles:Object(I.a)({},t,{padding:0,paddingTop:"1em"})},c.a.createElement(U.a,{column:!0,gap:"gap.large",hAlign:"center"},c.a.createElement(wt,{src:"/icons/location.png",to:"/locations"}),c.a.createElement(wt,{src:"/icons/camera.png",to:"/cameras"}),c.a.createElement(wt,{src:"/icons/part.png",to:"/parts"}),c.a.createElement(wt,{src:"/icons/manual.png",to:"/manual"}),c.a.createElement(wt,{src:"/icons/partIdentification.png",to:"/partIdentification"})))},wt=function(e){var t=e.src,n=e.to;return c.a.createElement(P.c,{to:n,style:{display:"flex",justifyContent:"center",padding:"0.8em"},activeStyle:{backgroundColor:"rgba(250, 83, 5, 0.5)"}},c.a.createElement(G.a,{src:t,design:{width:"100%"}}))},Rt={siteVariables:{colors:{brand:{50:"#f3fafd",100:"#d1ecf9",200:"#aadcf4",300:"#5dbce8",400:"#1ba0dd",500:"#0094d8",600:"#0085c3",700:"#0071a5",800:"#005379",900:"black"}},colorScheme:{brand:{foreground:"#0094d8",background:"#0094d8",border:"#E1DFDD",shadow:"#000",foregroundHover:"#0094d8",backgroundHover:"#0085c3",borderHover:"#5dbce8",shadowHover:"#000",foregroundActive:"#0094d8",backgroundActive:"#0094d8",borderActive:"#E1DFDD",shadowActive:void 0,foregroundFocus:"#0094d8",backgroundFocus:"#0094d8",borderFocus:"#000",shadowFocus:void 0,foregroundPressed:"#0071a5",backgroundPressed:"#0071a5",borderPressed:"#5dbce8",shadowPressed:void 0,foregroundDisabled:"#C8C6C4",backgroundDisabled:"#EDEBE9",borderDisabled:"#EDEBE9",shadowDisabled:void 0,foreground1:"#0094d8",foreground2:"#0085c3",foreground3:"#aadcf4",foreground4:"#fff",background1:"#d1ecf9",background2:"#005379",background3:"#373644",background4:"#0071a5",border1:"#aadcf4",border2:"#5dbce8",foregroundHover1:"#fff",foregroundHover2:"#aadcf4",backgroundHover1:"#f3fafd",foregroundPressed1:"#fff",foregroundActive1:"#0094d8",foregroundActive2:"#aadcf4",backgroundActive1:"#0094d8",borderActive1:"#aadcf4",borderActive2:"#5dbce8",foregroundFocus1:"#0094d8",foregroundFocus2:"#0085c3",foregroundFocus3:"#aadcf4",foregroundFocus4:"#fff",backgroundFocus1:"#d1ecf9",backgroundFocus2:"#005379",backgroundFocus3:"#373644",borderFocusWithin:"#fff",borderFocus1:"#0094d8",foregroundDisabled1:"#C8C6C4",backgroundDisabled1:"#EDEBE9"}}}},kt=Object(W.mergeThemes)(W.themes.teams,Rt),Lt=function(){return c.a.createElement(M.a,{theme:kt},c.a.createElement(P.a,null,c.a.createElement("div",{className:"App"},c.a.createElement(xt,null,c.a.createElement(It,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Nt=N(O),Pt=Nt.store,Mt=Nt.persistor;o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(l.a,{store:Pt},c.a.createElement(u.a,{loading:c.a.createElement("div",null,"Loading.."),persistor:Mt},c.a.createElement(Lt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[688,1,2]]]);
//# sourceMappingURL=main.4646d30d.chunk.js.map