(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{706:function(e,t,n){e.exports=n(954)},714:function(e,t,n){},953:function(e,t,n){},954:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(44),o=n.n(i),l=n(19),u=n(484),s=(n(714),n(93)),d=n(485),m=n(486),g=n(278),f=n(487),p=n.n(f);!function(e){e.None="none",e.WaitTraining="waitTraining",e.FinishTraining="finishTraining",e.TrainingFailed="trainingFailed",e.StartInference="startInference"}(a||(a={}));var E,h,b,v,y,O={dialogIsOpen:!1,cameras:[],locations:[],images:[],labelingPageState:{annotations:[]},part:{capturedImages:[],isValid:!0},project:{isLoading:!1,data:{id:null,camera:null,location:null,parts:[],needRetraining:!0,accuracyRangeMin:60,accuracyRangeMax:80,maxImages:20,modelUrl:"",sendMessageToCloud:!1,framesPerMin:6,accuracyThreshold:50,probThreshold:"10"},originData:{id:null,camera:null,location:null,parts:[],needRetraining:!0,accuracyRangeMin:60,accuracyRangeMax:80,maxImages:50,modelUrl:"",sendMessageToCloud:!1,framesPerMin:6,accuracyThreshold:50,probThreshold:"10"},trainingMetrics:{prevConsequence:null,curConsequence:null},inferenceMetrics:{successRate:null,successfulInferences:null,unIdetifiedItems:null,isGpu:!1,averageTime:null},status:a.None,error:null,trainingLog:""},setting:{loading:!1,error:null,current:{id:-1,key:"",namespace:""},origin:{id:-1,key:"",namespace:""},isTrainerValid:!1,appInsightHasInit:!1}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.cameras,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CAMERA_SUCCESS":return t.payload;case"REQUEST_CAMERA_FAILURE":return e;case"POST_CAMERA_SUCCESS":return e.concat(t.payload);case"DELETE_CAMERA_SUCCESS":var n=e.findIndex((function(e){return e.id===t.payload.id}));return-1!==n?e.slice(0,n).concat(e.slice(n+1)):e;default:return e}},C=n(59),S=n(11),I=(E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.part,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CAPTURED_IMAGE":return Object(S.a)({},e,{capturedImages:[].concat(Object(C.a)(e.capturedImages),[t.payload.newCapturedImage])});case"UPDATE_CAPTURED_IMAGES":return Object(S.a)({},e,{capturedImages:t.payload.capturedImages});default:return e}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.part,t=arguments.length>1?arguments[1]:void 0,n=E(e,t),a=n.capturedImages.filter((function(e){return e.labels})).length>=15;return Object(S.a)({},n,{isValid:a})});!function(e){e.Empty="Empty",e.P1Added="P1Added",e.Finish="Finish"}(h||(h={})),function(e){e.default="default",e.pointer="pointer",e.crosshair="crosshair",e.neswResize="nesw-resize",e.nwseResize="nwse-resize"}(b||(b={})),function(e){e.Creating="Creating",e.Selecting="Selecting",e.None="None"}(v||(v={})),function(e){e[e.SingleAnnotation=0]="SingleAnnotation",e[e.MultiAnnotation=1]="MultiAnnotation"}(y||(y={}));var T,x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.labelingPageState,t=arguments.length>1?arguments[1]:void 0,n=e;switch(t.type){case"REQUEST_ANNOTATION_SUCCESS":n.annotations=t.payload.annotations;break;case"REQUEST_ANNOTATION_FAILURE":break;case"CREATE_ANNOTATION":n.annotations.push(t.payload.annotation);break;case"UPDATE_CREATING_ANNOTATION":var a=t.payload.updater(n.annotations[n.annotations.length-1]);a.annotationState===h.Finish&&((0|a.label.x1)===(0|a.label.x2)&&(0|a.label.y1)===(0|a.label.y2)?n.annotations.pop():(n.annotations[n.annotations.length-1]=a,n.annotations=Object(C.a)(n.annotations)));break;case"UPDATE_ANNOTATION":n.annotations[t.payload.index]=t.payload.annotation;break;case"REMOVE_ANNOTATION":n.annotations=n.annotations.slice(0,t.payload.index).concat(n.annotations.slice(t.payload.index+1));break;case"RESET_ANNOTATION":n.annotations=O.labelingPageState.annotations;break;default:return e}return n},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.locations,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_LOCATION_SUCCESS":return t.payload;case"REQUEST_LOCATION_FAILURE":return e;case"POST_LOCATION_SUCCESS":return e.concat(t.payload);default:return e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.dialogIsOpen,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_DIALOG":return!0;case"CLOSE_DIALOG":return!1;default:return e}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.project,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_PROJECT_REQUEST":return Object(S.a)({},e,{isLoading:!0,error:null});case"GET_PROJECT_SUCCESS":return Object(S.a)({},e,{isLoading:!1,data:Object(S.a)({},t.payload.project),originData:Object(S.a)({},t.payload.project),error:null});case"GET_PROJECT_FAILED":return Object(S.a)({},e,{isLoading:!1,error:t.error});case"POST_PROJECT_REQUEST":return Object(S.a)({},e,{isLoading:!0});case"POST_PROJECT_SUCCESS":return Object(S.a)({},e,{isLoading:!1});case"POST_PROJECT_FALIED":return Object(S.a)({},e,{isLoading:!1,error:t.error});case"DELETE_PROJECT_SUCCESS":return Object(S.a)({},e,{isLoading:!1,data:{id:null,camera:null,location:null,parts:[],needRetraining:!0,accuracyRangeMin:60,accuracyRangeMax:80,maxImages:50,modelUrl:"",sendMessageToCloud:!1,framesPerMin:6,accuracyThreshold:50,probThreshold:"10"},originData:{id:null,camera:null,location:null,parts:[],needRetraining:!0,accuracyRangeMin:60,accuracyRangeMax:80,maxImages:50,modelUrl:"",sendMessageToCloud:!1,framesPerMin:6,accuracyThreshold:50,probThreshold:"10"},inferenceMetrics:{successRate:0,successfulInferences:0,unIdetifiedItems:0,isGpu:!1,averageTime:0},trainingMetrics:{curConsequence:null,prevConsequence:null},trainingLog:"",status:a.None,error:null});case"DELETE_PROJECT_FALIED":return Object(S.a)({},e);case"UPDATE_PROJECT_DATA":return Object(S.a)({},e,{data:Object(S.a)({},e.data,{},t.payload)});case"UPDATE_ORIGIN_PROJECT_DATA":return Object(S.a)({},e,{originData:e.data});case"GET_TRAINING_LOG_REQUEST":return Object(S.a)({},e);case"GET_TRAINING_LOG_SUCCESS":return Object(S.a)({},e,{trainingLog:t.payload.trainingLog,status:t.payload.newStatus});case"GET_TRAINING_LOG_FAILED":return Object(S.a)({},e,{trainingLog:"",data:Object(S.a)({},e.data),status:a.TrainingFailed,error:t.error});case"GET_TRAINING_METRICS_REQUEST":return e;case"GET_TRAINING_METRICS_SUCCESS":return Object(S.a)({},e,{trainingMetrics:t.payload,status:a.StartInference});case"GET_TRAINING_METRICS_FAILED":return Object(S.a)({},e,{error:t.error});case"GET_TRAINING_INFERENCE_REQUEST":return e;case"GET_INFERENCE_METRICS_SUCCESS":return Object(S.a)({},e,{inferenceMetrics:t.payload});case"GET_INFERENCE_METRICS_FAILED":return Object(S.a)({},e,{error:t.error});case"RESET_STATUS":return Object(S.a)({},e,{status:a.None});case"UPDATE_PROB_THRESHOLD_REQUEST":return Object(S.a)({},e,{isLoading:!0,error:null});case"UPDATE_PROB_THRESHOLD_SUCCESS":return Object(S.a)({},e,{isLoading:!1});case"UPDATE_PROB_THRESHOLD_FAILED":return Object(S.a)({},e,{isLoading:!1,error:t.error});default:return Object(S.a)({},e)}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.images,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_LABEL_IMAGE_SUCCESS":return t.payload;case"REQUEST_LABEL_IMAGE_FAILURE":return e;case"POST_LABEL_IMAGE_SUCCESS":return e.concat(t.payload);case"DELETE_LABEL_IMAGE_SUCCESS":var n=e.findIndex((function(e){return e.id===t.payload.id}));return-1!==n?e.slice(0,n).concat(e.slice(n+1)):e;case"UPDATE_LABEL_IMAGE_ANNOTATION":var a=Object(C.a)(e),r=a.findIndex((function(e){return e.id===t.payload.id}));return a[r]=Object(S.a)({},a[r],{labels:t.payload.labels}),a;default:return e}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.setting,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_KEY":return Object(S.a)({},e,{current:Object(S.a)({},e.current,{key:t.payload})});case"UPDATE_NAMESPACE":return Object(S.a)({},e,{current:Object(S.a)({},e.current,{namespace:t.payload})});case"REQUEST_START":return Object(S.a)({},e,{loading:!0});case"REQUEST_SUCCESS":return t.payload;case"REQUEST_FAIL":return Object(S.a)({},e,{error:t.error});case"GET_ALL_CV_PROJECTS_REQUEST":return Object(S.a)({},e,{loading:!0});case"GET_ALL_CV_PROJECTS_SUCCESS":return Object(S.a)({},e,{loading:!1,cvProjects:t.pyload});case"GET_ALL_CV_PROJECTS_ERROR":return Object(S.a)({},e,{loading:!1,error:t.error});default:return e}},P=Object(s.combineReducers)({cameras:j,locations:_,part:I,labelingPageState:x,dialogIsOpen:A,project:w,images:k,setting:R}),L={key:"root",storage:p.a},M=Object(g.a)(L,P),N=function(e){var t=[d.a],n=s.applyMiddleware.apply(void 0,t),a=Object(m.composeWithDevTools)(n),r=Object(s.createStore)(M,e,a);return{store:r,persistor:Object(g.b)(r)}},D=n(10),U=n(36),F=n(252),G=n(20),z=n.n(G),B=n(144),V=n(174),J=n(87),H=n(92),q=Object(r.memo)((function(e){var t=e.to,n=void 0===t?"":t,a=e.imgSrc,r=e.defaultSrc,i=e.bgImgSrc,o=e.label,l=void 0===o?"":o,u=e.imgPadding,s=void 0===u?"0.625em":u,d=e.width,m=void 0===d?"6.25em":d,g=e.height,f=void 0===g?"6.25em":g,p=e.bgImgStyle,E=e.pointerCursor,h=void 0!==E&&E,b=e.onClick;return c.a.createElement(V.a,{column:!0,styles:{width:m}},""===n?c.a.createElement("div",{style:{height:f},onClick:b},c.a.createElement(H.a,{src:null!==a&&void 0!==a?a:r,styles:Object(S.a)({padding:s,height:"100%",objectFit:"contain",backgroundImage:"url(".concat(i,")"),cursor:h?"pointer":"default"},p)})):c.a.createElement(U.b,{to:n},c.a.createElement("div",{style:{height:f},onClick:b},c.a.createElement(H.a,{src:null!==a&&void 0!==a?a:r,styles:Object(S.a)({padding:s,height:"100%",objectFit:"contain",backgroundImage:"url(".concat(i,")")},p)}))),c.a.createElement(J.a,{align:"center"},l))})),W=function(){return c.a.createElement(V.a,{column:!0,gap:"gap.medium"},c.a.createElement(J.a,{size:"larger",weight:"semibold"},"Hello User!"),c.a.createElement(J.a,{color:"white",styles:{backgroundColor:"#373644",padding:"0.125em 0.125em 0.125em 0.625em"}},"GET STARTED:"),c.a.createElement(V.a,{gap:"gap.large"},c.a.createElement(q,{imgSrc:"/icons/location-filled.png",to:"/locations",label:"Register a new Location",width:"6.25em"}),c.a.createElement(q,{imgSrc:"/icons/camera-filled.png",to:"/cameras",label:"Register a new Camera",width:"6.25em",imgPadding:"0.625em 0.1875em 0.625em 0.1875em"}),c.a.createElement(q,{imgSrc:"/icons/part-filled.png",to:"/parts",label:"Register a new Part",width:"6.25em"})),c.a.createElement(J.a,{color:"white",styles:{backgroundColor:"#373644",padding:"0.125em 0.125em 0.125em 0.625em"}},"SELECT FROM THE FOLLOWING TASKS:"),c.a.createElement(V.a,{gap:"gap.large"},c.a.createElement(q,{imgSrc:"/icons/doubleCube.png",to:"/partIdentification",label:"Identify Parts",width:"6.25em"}),c.a.createElement(q,{imgSrc:"/icons/manual-filled.png",to:"/manual",label:"Identify items manually",width:"6.25em"})))},Q=n(244),K=function(e){return alert(e),{type:"REQUEST_CAMERA_FAILURE"}},Y=function(){return function(e){return z()("/api/cameras/").then((function(t){var n=t.data;e(function(e){return{type:"GET_CAMERA_SUCCESS",payload:e}}(n))})).catch((function(t){e(K(t))}))}},X=function(e){return function(t){return z()("/api/cameras/",{method:"POST",data:e}).then((function(e){var n=e.data;t(function(e){return{type:"POST_CAMERA_SUCCESS",payload:e}}(n))})).catch((function(e){throw e.response?new Error(e.response.data.log):e.request?new Error(e.request):e})).catch((function(e){t(K(e))}))}},$=n(101),Z=n(254),ee=n(189),te=n(256),ne=n(970),ae=n(75),re=n(22),ce=function(e){var t=e.onClick;return c.a.createElement(ae.a,{primary:!0,fluid:!0,circular:!0,content:c.a.createElement(re.AddIcon,{size:"largest",circular:!0}),styles:{width:"6em",height:"6em"},onClick:t})},ie=function(e){var t=e.trigger,n=e.header,a=e.fields,i=e.onConfirm,o=Object(r.useState)(a.reduce((function(e,t){return Object(S.a)({},e,Object($.a)({},t.key,""))}),{})),l=Object(D.a)(o,2),u=l[0],s=l[1],d=a.some((function(e){return e.required&&!u[e.key]}));return c.a.createElement(Z.a,{styles:{display:"flex",flexDirection:"column",alignItems:"center",width:"500px"},confirmButton:{content:"Submit",disabled:d},cancelButton:"Cancel",onConfirm:function(){return i(u)},header:n,trigger:t||c.a.createElement("div",{style:{alignSelf:"flex-end"}},c.a.createElement(ce,null)),content:c.a.createElement(V.a,{column:!0,gap:"gap.large",hAlign:"center"},a.map((function(e){return"input"===e.type?c.a.createElement(ee.a,{key:e.key,placeholder:e.placeholder,value:u[e.key],onChange:function(t,n){var a=n.value;return s(ne.a(e.key,a,u))},fluid:!0,required:e.required}):c.a.createElement(te.a,{key:e.key,placeholder:e.placeholder,value:u[e.key],onChange:function(t,n){var a=n.value;return s(ne.a(e.key,a,u))},styles:{height:"100px"},fluid:!0,required:e.required})})))})},oe=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return{dialogIsOpen:e.dialogIsOpen,cameras:e.cameras.filter((function(e){return!e.is_demo}))}})).cameras;return Object(r.useEffect)((function(){e(Y())}),[e]),c.a.createElement("div",{style:{display:"flex",flexFlow:"column",justifyContent:"space-between",padding:"3em",height:"100%"}},c.a.createElement(Q.a,{columns:"8",styles:{height:"75%"}},t.map((function(e,t){return c.a.createElement(q,{key:t,to:"/cameras/detail?name=".concat(e.name),defaultSrc:"/icons/Play.png",bgImgSrc:"/icons/defaultCamera.png",width:"6.25em",height:"6.25em",bgImgStyle:{backgroundSize:"60%",backgroundPosition:"center",backgroundRepeat:"no-repeat"},label:e.name})}))),c.a.createElement(ie,{header:"Add Camera",fields:[{placeholder:"Name",key:"name",type:"input",required:!0},{placeholder:"RTSP URL",key:"rtsp",type:"input",required:!0}],onConfirm:function(t){var n=t.name,a=t.rtsp;e(X({name:n,rtsp:a,is_demo:!1}))}}))},le=n(257),ue=function(e){var t=e.trigger,n=e.onConfirm,a=e.primaryStyles,i=e.content,o=Object(r.useState)(!1),l=Object(D.a)(o,2),u=l[0],s=l[1];return c.a.createElement(Z.a,{trigger:t,styles:{width:"20em",padding:"0.5em"},open:u,onOpen:function(){return s(!0)},footer:c.a.createElement(V.a,{column:!0,gap:"gap.large"},c.a.createElement(J.a,{size:"large",align:"center"},i),c.a.createElement(V.a,{space:"around"},c.a.createElement(ae.a,{primary:!0,content:"Confirm",styles:a,onClick:n}),c.a.createElement(ae.a,{content:"Cancel",onClick:function(){return s(!1)}})))})},se=function(e){var t=Object(r.useState)([]),n=Object(D.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){var t=void 0===e?"/api/parts/":"/api/parts/?is_demo=".concat(Number(e));fetch(t).then((function(e){return e.json()})).then((function(e){c(e)})).catch((function(e){console.error(e)}))}),[e]),a},de=n(58),me=n.n(de),ge=n(89),fe=n(977),pe=n(976),Ee=n(276),he=n.n(Ee),be=n(253),ve=n(184),ye=n(30),Oe=n(97),je=n.n(Oe),Ce=n(978);!function(e){e[e.Disabled=0]="Disabled",e[e.Waiting=1]="Waiting",e[e.Creating=2]="Creating"}(T||(T={}));var Se=function(e){var t=e.getAbsoluteTransform().copy();t.invert();var n=e.getStage().getPointerPosition();return t.point(n)},Ie=function(e){var t=e.AOIs,n=e.setAOIs,a=e.visible,i=e.imageInfo,o=e.creatingState,l=e.setCreatingState,u=Object(r.useRef)(null),s=Object(r.useRef)(null),d=Object(r.useRef)(null),m=Object(r.useRef)(null),g=Object(D.a)(i,3),f=g[0],p=g[1],E=g[2],h=E.width,b=E.height;Object(r.useEffect)((function(){var e=new je.a.Animation((function(){}),m.current);return e.start(),function(){e.stop()}}),[]),Object(r.useEffect)((function(){var e=u.current.getBoundingClientRect(),t=e.width,n=e.height;s.current.width(t),s.current.height(n)}),[]),Object(r.useEffect)((function(){if(0!==h&&0!==b){var e=s.current.size(),t=e.width,n=e.height,a=Math.min(t/h,n/b);m.current.scale({x:a,y:a});var r=(t-h*a)/2,c=(n-b*a)/2;m.current.position({x:r,y:c})}}),[b,h]);return c.a.createElement("div",{ref:u,style:{width:"100%",height:"100%"}},c.a.createElement(ye.Stage,{ref:s,style:{cursor:o!==T.Disabled?"crosshair":""}},c.a.createElement(ye.Layer,{ref:m,onMouseDown:function(e){if(o!==T.Disabled){var t=Se(e.target.getLayer()),a=t.x,r=t.y;n((function(e){return[].concat(Object(C.a)(e),[{id:he()(),x1:a,y1:r,x2:a,y2:r}])})),l(T.Creating)}},onMouseMove:function(e){if(o===T.Creating){var t=Se(e.target.getLayer()),a=t.x,r=t.y;n(Ce.a(-1,(function(e){return Object(S.a)({},e,{x2:a,y2:r})})))}},onMouseUp:function(){o===T.Creating&&l(T.Disabled)}},c.a.createElement(ye.Image,{image:f,ref:d}),"loaded"===p&&c.a.createElement(Te,{imgWidth:h,imgHeight:b,AOIs:t,setAOIs:n,visible:a,creatingState:o}))))},Te=function(e){var t=e.imgWidth,n=e.imgHeight,a=e.AOIs,r=e.setAOIs,i=e.visible,o=e.creatingState;return c.a.createElement(c.a.Fragment,null,c.a.createElement(xe,{width:t,height:n,holes:a,visible:i}),a.map((function(e,a){return c.a.createElement(_e,{key:e.id,box:e,visible:i,boundary:{x1:0,y1:0,x2:t,y2:n},onBoxChange:function(e){return r((function(t){var n=e(t[a]);if(n.x1>n.x2){var r=n.x1;n.x1=n.x2,n.x2=r}if(n.y1>n.y2){var c=n.y1;n.y1=n.y2,n.y2=c}var i=Object(C.a)(t);return i[a]=n,i}))},removeBox:function(e){r((function(t){return t.filter((function(t){return t.id!==e}))}))},creatingState:o})})))},xe=function(e){var t=e.width,n=e.height,a=e.holes,r=e.visible;return c.a.createElement(ye.Shape,{width:t,height:n,fill:"rgba(0,0,0,0.5)",visible:r,sceneFunc:function(e,t){e.beginPath(),e.moveTo(0,0),e.lineTo(t.width(),0),e.lineTo(t.width(),t.height()),e.lineTo(0,t.height()),e.lineTo(0,0),a.forEach((function(t){var n=t.x1,a=t.y1,r=t.x2,c=t.y2;e.moveTo(n,a),e.lineTo(n,c),e.lineTo(r,c),e.lineTo(r,a),e.lineTo(n,a)})),e.fillStrokeShape(t)},listening:!1})},_e=function(e){var t,n=e.box,a=e.onBoxChange,i=e.visible,o=e.boundary,l=e.removeBox,u=e.creatingState,s=n.x1,d=n.y1,m=n.x2,g=n.y2,f=Object(r.useState)(!1),p=Object(D.a)(f,2),E=p[0],h=p[1],b=Object(r.useRef)(null),v=function(e){var t=e.target.position(),n=t.x,r=t.y;switch(n<o.x1&&(n=o.x1,e.target.x(n)),n>o.x2&&(n=o.x2,e.target.x(n)),r<o.y1&&(r=o.y1,e.target.y(r)),r>o.y2&&(r=o.y2,e.target.y(r)),e.target.name()){case"leftTop":a((function(e){return Object(S.a)({},e,{x1:n,y1:r})}));break;case"rightTop":a((function(e){return Object(S.a)({},e,{x2:n,y1:r})}));break;case"rightBottom":a((function(e){return Object(S.a)({},e,{x2:n,y2:r})}));break;case"leftBottom":a((function(e){return Object(S.a)({},e,{x1:n,y2:r})}))}},y=(null===(t=b.current)||void 0===t?void 0:t.getLayer().scale().x)||1,O=5/y;return c.a.createElement(ye.Group,{visible:i,onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)},cache:[{drawBorder:!0}],ref:b},c.a.createElement(ye.Line,{x:s,y:d-80,points:[0,-80,0,g-d,m-s,g-d,m-s,-80],closed:!0}),c.a.createElement(ye.Line,{x:s,y:d,points:[0,0,0,g-d,m-s,g-d,m-s,0],closed:!0,stroke:"white",strokeWidth:2/y}),c.a.createElement(ye.Circle,{draggable:!0,name:"leftTop",x:s,y:d,radius:O,fill:"white",onDragMove:v}),c.a.createElement(ye.Circle,{draggable:!0,name:"rightTop",x:m,y:d,radius:O,fill:"white",onDragMove:v}),c.a.createElement(ye.Circle,{draggable:!0,name:"rightBottom",x:m,y:g,radius:O,fill:"white",onDragMove:v}),c.a.createElement(ye.Circle,{draggable:!0,name:"leftBottom",x:s,y:g,radius:O,fill:"white",onDragMove:v}),c.a.createElement(ye.Path,{x:s,y:d-30/y,data:"M 0 0 L 20 20 M 20 0 L 0 20",stroke:"red",strokeWidth:5,visible:E&&u===T.Disabled,onMouseEnter:function(e){e.target.getStage().container().style.cursor="pointer"},onMouseLeave:function(e){e.target.getStage().container().style.cursor="default"},onClick:function(){return l(n.id)},scale:{x:1/y,y:1/y}}))},Ae={image:void 0,status:"loading",size:{width:0,height:0}},we=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current},ke=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Object(r.useState)(Ae),c=Object(D.a)(a,2),i=c[0],o=c[1],l=i.image,u=i.status,s=i.size,d=we(e),m=we(null===l||void 0===l?void 0:l.width),g=we(null===l||void 0===l?void 0:l.height);return Object(r.useEffect)((function(){if(e){var n=document.createElement("img");e!==d&&o((function(e){return Object(S.a)({},e,{image:e.image,status:"loading"})}));var a=function(){o({image:n,status:"loaded",size:{width:n.width,height:n.height}})},r=function(){o((function(e){return Object(S.a)({},e,{image:void 0,status:"failed"})}))};return n.addEventListener("load",a),n.addEventListener("error",r),t&&(n.crossOrigin=t),n.src=e,function(){n.removeEventListener("load",a),n.removeEventListener("error",r)}}}),[e,t,d]),Object(r.useEffect)((function(){var e;if(n)return e=window.requestAnimationFrame((function t(){m===(null===l||void 0===l?void 0:l.width)&&g===(null===l||void 0===l?void 0:l.height)||o((function(e){return Object(S.a)({},e,{size:{width:null===l||void 0===l?void 0:l.width,height:null===l||void 0===l?void 0:l.height}})})),e=window.requestAnimationFrame(t)})),function(){return window.cancelAnimationFrame(e)}}),[n,l,m,g]),[l,u,s]},Re=function(e){var t=e.showVideo,n=e.initialAOIData,a=e.cameraId,i=Object(r.useState)(n.useAOI),o=Object(D.a)(i,2),l=o[0],u=o[1],s=Object(r.useRef)(n.AOIs),d=Object(r.useState)(s.current),m=Object(D.a)(d,2),g=m[0],f=m[1],p=Object(r.useState)(!1),E=Object(D.a)(p,2),h=E[0],b=E[1],v=Object(r.useState)(!1),y=Object(D.a)(v,2),O=y[0],j=y[1],C=Object(r.useState)(null),S=Object(D.a)(C,2),I=S[0],x=S[1],_=ke("http://".concat(window.location.hostname,":5000/video_feed?inference=1"),"",!0),A=Object(r.useState)(T.Disabled),w=Object(D.a)(A,2),k=w[0],R=w[1],P=function(){var e=Object(ge.a)(me.a.mark((function e(){return me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!l),j(!0),e.prev=2,e.next=5,z.a.patch("/api/cameras/".concat(a,"/"),{area:JSON.stringify({useAOI:!l,AOIs:s.current})});case 5:b(!0),l||f(s.current),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),u(l),x(e.t0);case 13:j(!1);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(ge.a)(me.a.mark((function e(){return me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,z.a.patch("/api/cameras/".concat(a,"/"),{area:JSON.stringify({useAOI:l,AOIs:g})});case 4:b(!0),s.current=fe.a(g),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),x(e.t0);case 11:j(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){if(h){var e=setTimeout((function(){b(!1)}),3e3);return function(){return clearTimeout(e)}}}),[h]),Object(r.useEffect)((function(){g.length||f([{id:he()(),x1:.1*_[2].width,y1:.1*_[2].height,x2:.9*_[2].width,y2:.9*_[2].height}])}),[g.length,_[2].width,_[2].height]);var M=!pe.a(s.current,g),N=!l||!M;return c.a.createElement(V.a,{column:!0,gap:"gap.medium"},c.a.createElement(V.a,{space:"between"},c.a.createElement(J.a,{styles:{width:"150px"},size:"medium"},"Live View:"),I&&c.a.createElement(be.a,{danger:!0,header:"Failed to Update!",content:"".concat(I.name,": ").concat(I.message)}),c.a.createElement(V.a,{hAlign:"end",gap:"gap.small"},c.a.createElement(ve.a,{labelPosition:"start",label:"Show area of interest",toggle:!0,checked:l,onClick:P}),c.a.createElement(ae.a,{content:"Update",primary:!0,disabled:N,onClick:L,loading:O}),c.a.createElement(ae.a,{content:"Create Area of Interest",primary:k!==T.Disabled,disabled:!l,onClick:function(){k===T.Disabled?R(T.Waiting):R(T.Disabled)},circular:!0,styles:{padding:"0 5px"}}),c.a.createElement(J.a,{styles:{visibility:h?"visible":"hidden"}},"Updated!"))),c.a.createElement("div",{style:{width:"100%",height:"50vh",backgroundColor:"black"}},t?c.a.createElement(Ie,{AOIs:g,setAOIs:f,visible:l,imageInfo:_,creatingState:k,setCreatingState:R}):null))},Pe=function(e){var t=e.title,n=e.footerText,a=void 0===n?"":n,r=e.children;return c.a.createElement("div",null,c.a.createElement(V.a,{vAlign:"center",gap:"gap.medium"},c.a.createElement(J.a,{style:{width:"200px"},size:"medium"},"".concat(t,": ")),"string"===typeof r||"number"===typeof r?c.a.createElement(J.a,{size:"medium"},r):r),c.a.createElement(J.a,{size:"smallest",error:!0},a))},Le=function(e){var t=e.online,n=t?"Online":"Offline",a=t?"success":"unknown";return c.a.createElement(V.a,{gap:"gap.smaller",vAlign:"center"},c.a.createElement(le.a,{state:a}),c.a.createElement(J.a,{styles:{margin:"5px"},size:"medium"},n))},Me=Object(r.memo)((function(e){var t=e.id,n=e.name,r=e.rtsp,i=e.AOIs,o=Object(l.b)(),u=Object(l.c)((function(e){return e.project})),s=u.data,d=u.status,m=se(),g=[a.FinishTraining,a.StartInference].includes(d);return c.a.createElement(V.a,{styles:{padding:"1em 2em"},column:!0,gap:"gap.medium"},c.a.createElement("h1",null,"Details"),c.a.createElement(Q.a,{columns:"2",styles:{gap:"3em"}},c.a.createElement(V.a,{column:!0,gap:"gap.medium"},c.a.createElement(J.a,{size:"medium",content:"Name: ".concat(n)}),c.a.createElement(J.a,{size:"medium",content:"RTSP Url: ".concat(r)})),c.a.createElement(ue,{trigger:c.a.createElement(ae.a,{primary:!0,content:"Delete Camera",styles:{backgroundColor:"#C4314B",":hover":{backgroundColor:"#A72037"},":active":{backgroundColor:"#8E192E"}}}),content:"Delete Camera",primaryStyles:{backgroundColor:"#C4314B",":hover":{backgroundColor:"#A72037"},":active":{backgroundColor:"#8E192E"}},onConfirm:function(){o(function(e){return function(t){return z()("/api/cameras/".concat(e,"/"),{method:"DELETE"}).then((function(){t(function(e){return{type:"DELETE_CAMERA_SUCCESS",payload:{id:e}}}(e))})).catch((function(e){t(K(e))}))}}(t))}})),d!==a.WaitTraining&&d!==a.None&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Pe,{title:"Status"},c.a.createElement(Le,{online:g})),c.a.createElement(Pe,{title:"Configured for"},m.filter((function(e){return s.parts.includes(e.id)})).map((function(e){return e.name})).join(", ")),c.a.createElement(Re,{showVideo:!0,initialAOIData:i,cameraId:s.camera})))})),Ne=n(117),De=function(e,t){var n=Object(r.useRef)(null);Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])},Ue=function(e,t){return{type:"GET_TRAINING_LOG_SUCCESS",payload:{trainingLog:e,newStatus:t}}},Fe=function(e){return{type:"POST_PROJECT_FALIED",error:e}},Ge=function(e){return{type:"UPDATE_PROJECT_DATA",payload:e}},ze=function(e){return function(t){t({type:"GET_PROJECT_REQUEST"});var n=void 0===e?"/api/projects/":"/api/projects/?is_demo=".concat(Number(e));return z.a.get(n).then((function(e){var n,a,r,c,i,o,l,u,s,d,m,g,f,p,E,h,b,v,y,O,j,C,S,I,T=e.data,x={id:null!==(n=null===(a=T[0])||void 0===a?void 0:a.id)&&void 0!==n?n:null,camera:null!==(r=parseInt(null===(c=T[0])||void 0===c?void 0:c.camera.split("/")[5],10))&&void 0!==r?r:null,location:null!==(i=parseInt(null===(o=T[0])||void 0===o?void 0:o.location.split("/")[5],10))&&void 0!==i?i:null,parts:null!==(l=null===(u=T[0])||void 0===u?void 0:u.parts.map((function(e){return parseInt(e.split("/")[5],10)})))&&void 0!==l?l:[],modelUrl:null!==(s=null===(d=T[0])||void 0===d?void 0:d.download_uri)&&void 0!==s?s:"",needRetraining:null===(m=null===(g=T[0])||void 0===g?void 0:g.needRetraining)||void 0===m||m,accuracyRangeMin:null!==(f=null===(p=T[0])||void 0===p?void 0:p.accuracyRangeMin)&&void 0!==f?f:60,accuracyRangeMax:null!==(E=null===(h=T[0])||void 0===h?void 0:h.accuracyRangeMax)&&void 0!==E?E:80,maxImages:null!==(b=null===(v=T[0])||void 0===v?void 0:v.maxImages)&&void 0!==b?b:20,sendMessageToCloud:null===(y=T[0])||void 0===y?void 0:y.metrics_is_send_iothub,framesPerMin:null===(O=T[0])||void 0===O?void 0:O.metrics_frame_per_minutes,accuracyThreshold:null===(j=T[0])||void 0===j?void 0:j.metrics_accuracy_threshold,cvProjectId:null===(C=T[0])||void 0===C?void 0:C.customvision_project_id,probThreshold:null!==(S=null===(I=T[0])||void 0===I?void 0:I.prob_threshold.toString())&&void 0!==S?S:"10"};t(function(e){return{type:"GET_PROJECT_SUCCESS",payload:{project:e}}}(x))})).catch((function(e){t({type:"GET_PROJECT_FAILED",error:e})}))}},Be=function(e,t,n,a,r){return function(c,i){var o=null===e,l=o?"/api/projects/":"/api/projects/".concat(e,"/");c({type:"POST_PROJECT_REQUEST"});var u=i().project.data;return z()(l,{data:{location:"http://localhost:8000/api/locations/".concat(t.id,"/"),parts:n.map((function(e){return"http://localhost:8000/api/parts/".concat(e.id,"/")})),camera:"http://localhost:8000/api/cameras/".concat(a.id,"/"),download_uri:u.modelUrl,needRetraining:u.needRetraining,accuracyRangeMin:u.accuracyRangeMin,accuracyRangeMax:u.accuracyRangeMax,maxImages:u.maxImages,metrics_is_send_iothub:u.sendMessageToCloud,metrics_frame_per_minutes:u.framesPerMin,metrics_accuracy_threshold:u.accuracyThreshold},method:o?"POST":"PUT",headers:{"Content-Type":"application/json"}}).then((function(e){var t=e.data;return c({type:"POST_PROJECT_SUCCESS"}),Ve(t.id,r),t.id})).catch((function(e){c(Fe(e))}))}},Ve=function(e,t){var n="/api/projects/".concat(e,t?"/train?demo=True":"/train");z.a.get(n).catch((function(e){return console.error(e)}))},Je=function(e){return function(t){return t({type:"GET_TRAINING_LOG_REQUEST"}),z.a.get("/api/projects/".concat(e,"/export")).then((function(e){var n=e.data;if("failed"===n.status)throw new Error(n.log);"ok"===n.status||"demo ok"===n.status?t(Ue("",a.FinishTraining)):t(Ue(n.log,a.WaitTraining))})).catch((function(e){return t({type:"GET_TRAINING_LOG_FAILED",error:e})}))}},He=function(){return new URLSearchParams(Object(B.i)().search)},qe=function(e){var t=e.projectId;return c.a.createElement(V.a,{column:!0,gap:"gap.large"},c.a.createElement("h1",null,"Configuration"),c.a.createElement(We,{projectId:t}))},We=function(e){var t=e.projectId,n=Object(l.c)((function(e){return e.project})),i=n.error,o=n.trainingLog,u=n.status,s=n.trainingMetrics,d=n.isLoading,m=n.inferenceMetrics,g=n.data,f=Ye(o),p=Object(l.b)(),E=He().get("name"),h="true"===He().get("isDemo"),b=Object(B.h)(),v=Object(r.useState)(!1),y=Object(D.a)(v,2),O=y[0],j=y[1],C=Qe(m.successfulInferences,6e4),S=Qe(m.successfulInferences,12e4),I=Object(r.useCallback)((function(){confirm("Delete this configuration?")&&p(function(e){return function(t){return z.a.get("/api/projects/".concat(e,"/reset_camera")).then((function(){return t({type:"DELETE_PROJECT_SUCCESS"})})).catch((function(e){alert(e),t({type:"DELETE_PROJECT_FALIED"})}))}}(t)).then((function(e){if(e)return b.push("/cameras/detail?name=".concat(E))})).catch((function(e){return console.error(e)}))}),[p,b,E,t]);return Object(r.useEffect)((function(){p(Je(t))}),[p,t]),De((function(){p(Je(t))}),u===a.WaitTraining?5e3:null),Object(r.useEffect)((function(){u===a.FinishTraining&&p(function(e){return function(t){return t({type:"GET_TRAINING_METRICS_REQUEST"}),z.a.get("/api/projects/".concat(e,"/train_performance")).then((function(e){var n=e.data,a=n.new?{precision:n.new.precision,recall:n.new.recall,mAP:n.new.map}:null,r=n.previous?{precision:n.previous.precision,recall:n.previous.recall,mAP:n.previous.map}:null;return t(function(e,t){return{type:"GET_TRAINING_METRICS_SUCCESS",payload:{prevConsequence:t,curConsequence:e}}}(a,r))})).catch((function(e){return t({type:"GET_TRAINING_METRICS_FAILED",error:e})}))}}(t))}),[p,u,t]),De((function(){p(function(e){return function(t){return t({type:"GET_TRAINING_INFERENCE_REQUEST"}),z.a.get("/api/projects/".concat(e,"/export")).then((function(e){var n,a,r,c,i,o=e.data;return t((n=o.success_rate,a=o.inference_num,r=o.unidentified_num,c=o.gpu,i=o.average_time,{type:"GET_INFERENCE_METRICS_SUCCESS",payload:{successRate:n,successfulInferences:a,unIdetifiedItems:r,isGpu:c,averageTime:i}}))})).catch((function(e){return t({type:"GET_INFERENCE_METRICS_FAILED",error:e})}))}}(t))}),u===a.StartInference?5e3:null),Object(r.useEffect)((function(){return function(){p({type:"RESET_STATUS"})}}),[p]),u===a.WaitTraining||u===a.None?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ne.a,{size:"smallest"}),c.a.createElement("pre",null,f)):c.a.createElement(c.a.Fragment,null,i&&c.a.createElement(be.a,{danger:!0,header:i.name,content:"".concat(i.message)}),c.a.createElement(Pe,{title:"Maximum Confidence Level"},c.a.createElement(ee.a,{value:g.probThreshold,onChange:function(e,t){var n=t.value;p(Ge({probThreshold:n}))}}),c.a.createElement("span",null,"%"),c.a.createElement(ae.a,{primary:!0,content:"Update Confidence Level",onClick:function(){p((function(e,t){e({type:"UPDATE_PROB_THRESHOLD_REQUEST"});var n=t().project.data.id,a=t().project.data.probThreshold;return z.a.get("/api/projects/".concat(n,"/update_prob_threshold?prob_threshold=").concat(a)).then((function(){return e({type:"UPDATE_PROB_THRESHOLD_SUCCESS"})})).catch((function(e){throw e.response?new Error(e.response.data.log):e.request?new Error(e.request):e})).catch((function(t){e({type:"UPDATE_PROB_THRESHOLD_FAILED",error:t})}))}))},disabled:!g.probThreshold||d,loading:d})),c.a.createElement(Q.a,{columns:2,styles:{rowGap:"20px"}},c.a.createElement(Pe,{title:"Success Rate"},c.a.createElement(J.a,{styles:{color:"rgb(244, 152, 40)",fontWeight:"bold"},size:"medium"},"".concat(m.successRate,"%"))),c.a.createElement(Pe,{title:"Running on ".concat(m.isGpu?"GPU":"CPU"," (accelerated)")},"".concat(Math.round(100*m.averageTime)/100,"/ms")),c.a.createElement("div",{style:{gridColumn:"1 / span 2"}},c.a.createElement(Pe,{title:"Successful Inferences",footerText:C?"If you are not seeing inference result, we recommend to change the confidence level to 10%.":""},m.successfulInferences))),c.a.createElement(Pe,{title:"Unidentified Items",footerText:S?"If you are not receiving any images, we recommend to change the accuracy range to minimum 10%.":""},c.a.createElement(J.a,{styles:{margin:"5px"},size:"medium"},m.unIdetifiedItems),c.a.createElement(ae.a,{content:"Identify Manually",primary:!0,styles:{marginLeft:"100px"},as:U.b,to:"/manual"})),c.a.createElement(J.a,null,"Accuracy Range: "),c.a.createElement(V.a,{gap:"gap.medium",vAlign:"center"},c.a.createElement(J.a,null,"Minimum:"),c.a.createElement(ee.a,{value:g.accuracyRangeMin,type:"number",onChange:function(e,t){var n=t.value;p(Ge({accuracyRangeMin:parseInt(n,10)}))}}),c.a.createElement(J.a,null,"%"),c.a.createElement(J.a,null,"Maximum:"),c.a.createElement(ee.a,{value:g.accuracyRangeMax,type:"number",onChange:function(e,t){var n=t.value;p(Ge({accuracyRangeMax:parseInt(n,10)}))}}),c.a.createElement(J.a,null,"%"),c.a.createElement(ae.a,{content:"Update Accuracy Range",primary:!0,loading:d,disabled:d,onClick:function(){p((function(e,t){e({type:"POST_PROJECT_REQUEST"});var n=t().project.data.id,a=t().project.data,r=a.accuracyRangeMin,c=a.accuracyRangeMax;return z.a.patch("/api/projects/".concat(n,"/"),{accuracyRangeMin:r,accuracyRangeMax:c}).then((function(){e({type:"POST_PROJECT_SUCCESS"})})).catch((function(e){throw e.response?new Error(e.response.data.log):e.request?new Error(e.request):e})).catch((function(t){e(Fe(t))}))}))}})),c.a.createElement(V.a,{hAlign:"center",column:!0,gap:"gap.large",styles:{paddingTop:"70px"}},c.a.createElement(ae.a,{content:O?"Hide detail for training metric":"Show detail training metric",primary:!0,onClick:function(){return j((function(e){return!e}))}}),O&&c.a.createElement(Xe,{trainingMetrics:s})),c.a.createElement(V.a,{gap:"gap.medium",styles:{marginTop:"auto"},hAlign:"center"},c.a.createElement(ae.a,{primary:!0,as:U.b,to:"/partIdentification"},"Edit Configuration"),c.a.createElement(ae.a,{primary:!0,disabled:h,onClick:I},"Delete Configuration")))};function Qe(e,t){var n=Object(r.useState)(!1),a=Object(D.a)(n,2),c=a[0],i=a[1];return Object(r.useEffect)((function(){var e;return c&&(e=setTimeout((function(){return i(!1)}),1e4)),function(){e&&clearTimeout(e)}}),[c]),Object(r.useEffect)((function(){if(0===e){var n=setTimeout((function(){0===e&&i(!0)}),t);return function(){return clearTimeout(n)}}}),[t,e]),c}var Ke,Ye=function(e){var t=Object(r.useState)(e),n=Object(D.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){c((function(t){return"".concat(t,"\n").concat(e)}))}),[e]),a},Xe=function(e){var t=e.trainingMetrics,n=t.curConsequence,a=t.prevConsequence;return c.a.createElement("table",{style:{textAlign:"center",width:"60%"}},c.a.createElement("tr",null,c.a.createElement("td",{style:{width:"200px"}}),c.a.createElement("td",null,"Precision"),c.a.createElement("td",null,"Recall"),c.a.createElement("td",null,"mAP")),c.a.createElement("tr",null,c.a.createElement("td",null,"Updated Model Metrics"),c.a.createElement("td",{style:{color:"#9a0089"}},null===(null===n||void 0===n?void 0:n.precision)?"":"".concat((1e3*(null===n||void 0===n?void 0:n.precision)|0)/10,"%")),c.a.createElement("td",{style:{color:"#0063b1"}},null===(null===n||void 0===n?void 0:n.recall)?"":"".concat((1e3*(null===n||void 0===n?void 0:n.recall)|0)/10,"%")),c.a.createElement("td",{style:{color:"#69c138"}},null===(null===n||void 0===n?void 0:n.mAP)?"":"".concat((1e3*(null===n||void 0===n?void 0:n.mAP)|0)/10,"%"))),a&&c.a.createElement("tr",null,c.a.createElement("td",null,"Previous Model Metrics"),c.a.createElement("td",{style:{color:"#9a0089"}},null===(null===a||void 0===a?void 0:a.precision)?"":"".concat((1e3*(null===a||void 0===a?void 0:a.precision)|0)/10,"%")),c.a.createElement("td",{style:{color:"#0063b1"}},null===(null===a||void 0===a?void 0:a.recall)?"":"".concat((1e3*(null===a||void 0===a?void 0:a.recall)|0)/10,"%")),c.a.createElement("td",{style:{color:"#69c138"}},null===(null===a||void 0===a?void 0:a.mAP)?"":"".concat((1e3*(null===a||void 0===a?void 0:a.mAP)|0)/10,"%"))))},$e=function(){return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement("h1",null,"Configuration"),c.a.createElement(V.a,{hAlign:"center",vAlign:"center",design:{height:"100%"},column:!0,gap:"gap.large"},c.a.createElement(ae.a,{fluid:!0,circular:!0,content:c.a.createElement(re.AddIcon,{size:"largest",circular:!0,color:"brand"}),style:{width:100,height:100,border:"5px solid #0094d8"},color:"brand",as:U.b,to:"/partIdentification"}),c.a.createElement("h2",null,"Configure Task for the Device")))},Ze=function(){var e=Object(l.c)((function(e){return e.project.data.camera})),t=Object(l.c)((function(e){return e.project.data.id})),n=Object(l.b)(),a=He().get("name"),i=He().get("isDemo"),o=Object(l.c)((function(e){return e.cameras.find((function(e){return e.name===a}))}));if(Object(r.useEffect)((function(){n(ze("true"===i)),n(Y())}),[n,i]),!o)return c.a.createElement(B.b,{to:"/cameras"});var u=e===o.id,s=et(o.area);return c.a.createElement(Q.a,{columns:"2",design:{height:"100%"}},c.a.createElement(Me,{id:o.id,name:a,rtsp:o.rtsp,AOIs:s}),u?c.a.createElement(qe,{projectId:t}):c.a.createElement($e,null))},et=function(e){try{return JSON.parse(e)}catch(t){return{useAOI:!1,AOIs:[]}}},tt=n(136),nt=n(185),at=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.cameras.filter((function(e){return!e.is_demo}))}));return Object(r.useEffect)((function(){e(Y())}),[e]),t},rt=function(e){return function(t){if(0!==t.width){if(t.width>t.height){var n=e.width/t.width;return[{width:e.width,height:t.height*n},n]}var a=e.height/t.height;return[{height:e.height,width:t.width*a},a]}return[e,1]}},ct=function(e){return{type:"REQUEST_ANNOTATION_SUCCESS",payload:{annotations:e}}},it={init:function(){return{id:null,label:{x1:0,y1:0,x2:0,y2:0},attribute:"",annotationState:h.Empty}},createWithPoint:function(e,t){var n=Object(S.a)({},this.init(),{attribute:t});return this.add(e,n)},add:function(e,t){var n=e.x,a=e.y,r=Object(S.a)({},t);return t.annotationState===h.Empty?(r.label.x1=n,r.label.y1=a,r.label.x2=n,r.label.y2=a,r.annotationState=h.P1Added):t.annotationState===h.P1Added&&(r.label.x2=n,r.label.y2=a,r.annotationState=h.Finish),this.setVerticesToValidValue(r)},setVerticesToInt:function(e){var t=Object(S.a)({},e),n=t.label,a=n.x1,r=n.y1,c=n.x2,i=n.y2;return t.label={x1:Math.round(a),y1:Math.round(r),x2:Math.round(c),y2:Math.round(i)},t},setVerticesPointsOrder:function(e){var t=Object(S.a)({},e),n=t.label,a=n.x1,r=n.y1,c=n.x2,i=n.y2;return a>c&&(t.label.x1=c,t.label.x2=a),r>i&&(t.label.y1=i,t.label.y2=r),t},setVerticesToValidValue:function(e){return this.setVerticesPointsOrder(this.setVerticesToInt(e))}},ot=function(e){var t=e.scale,n=e.workState,a=e.onSelect,i=e.selected,o=e.annotationIndex,l=e.visible,u=void 0===l||l,s=e.annotation,d=e.dispatch,m=e.changeCursorState,g=void 0===m?null:m,f=Object(r.useState)(s.label),p=Object(D.a)(f,2),E=p[0],h=p[1],y=5/t,O=2/t,j=Object(r.useRef)(null),C=function(){if(g(),d){var e=Object(S.a)({},s);e.label=E,d(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return{type:"UPDATE_ANNOTATION",payload:{index:e,annotation:it.setVerticesToValidValue(t)}}}(o,e))}},I=Object(r.useCallback)((function(e){n===v.Creating&&i&&h((function(n){return Object(S.a)({},n,{x2:e.evt.offsetX/t,y2:e.evt.offsetY/t})}))}),[n,h,i,t]),T=Object(r.useCallback)((function(e){var n=e.xi,a=void 0===n?"x1":n,r=e.yi,c=void 0===r?"y1":r;return function(e){var n=e.target.getStage().getSize(),r=n.width,i=n.height,o=Math.round(e.target.position().x),l=Math.round(e.target.position().y);o<0&&(o=0),l<0&&(l=0),o>r/t&&(o=r/t),l>i/t&&(l=i/t),e.target.setAttr("x",o),e.target.setAttr("y",l);var u=["x1","x2"],s=["y1","y2"];u.splice(u.findIndex((function(e){return e===a})),1),s.splice(s.findIndex((function(e){return e===c})),1),E[u[0]]>E[a]?E[s[0]]>E[c]?g(b.nwseResize):g(b.neswResize):E[s[0]]>E[c]?g(b.neswResize):g(b.nwseResize),h((function(e){var t;return Object(S.a)({},e,(t={},Object($.a)(t,a,o),Object($.a)(t,c,l),t))}))}}),[g,t,E]);return Object(r.useEffect)((function(){var e=j.current.getLayer();return e.on("mousemove",I),function(){e.off("mousemove",I)}}),[I]),Object(r.useEffect)((function(){h(s.label)}),[s.label]),c.a.createElement(ye.Group,{ref:function(e){e&&(j.current=e)},visible:u,onMouseDown:function(e){n===v.None&&(a(o),e.cancelBubble=!0)}},c.a.createElement(ye.Line,{points:[E.x1,E.y1,E.x2,E.y1,E.x2,E.y2,E.x1,E.y2,E.x1,E.y1],stroke:"red",strokeWidth:O,closed:!0}),c.a.createElement(ye.Group,{visible:i},c.a.createElement(ye.Circle,{key:"anchor-0",name:"anchor-0",x:E.x1,y:E.y1,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x1",yi:"y1"}),onDragEnd:C,onMouseEnter:function(){n!==v.Creating&&g(b.nwseResize)},onMouseLeave:function(){g()}}),c.a.createElement(ye.Circle,{key:"anchor-1",name:"anchor-1",x:E.x2,y:E.y1,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x2",yi:"y1"}),onDragEnd:C,onMouseEnter:function(){n!==v.Creating&&g(b.neswResize)},onMouseLeave:function(){g()}}),c.a.createElement(ye.Circle,{key:"anchor-2",name:"anchor-2",x:E.x2,y:E.y2,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x2",yi:"y2"}),onDragEnd:C,onMouseEnter:function(){n!==v.Creating&&g(b.nwseResize)},onMouseLeave:function(){g()}}),c.a.createElement(ye.Circle,{key:"anchor-3",name:"anchor-3",x:E.x1,y:E.y2,radius:y,fill:"red",draggable:!0,onDragMove:T({xi:"x1",yi:"y2"}),onDragEnd:C,onMouseEnter:function(){n!==v.Creating&&g(b.neswResize)},onMouseLeave:function(){g()}})))},lt=Object(r.memo)((function(e){var t,n,a=e.visible,i=e.imageSize,o=e.label,l=e.changeCursorState,u=e.scale,s=e.setShowOuterRemoveButton,d=e.removeBox,m=Object(r.useState)("#F9526B"),g=Object(D.a)(m,2),f=g[0],p=g[1],E=Object(r.useState)(1.5/u),h=Object(D.a)(E,2),v=h[0],y=h[1];return o.x1<0||o.x2>i.width/u||o.y1<0||o.y2>i.height/u?(t=0,n=-60):o.x1>30/u||o.x2<(i.width-25)/u?(t=o.x1>30/u?o.x1-20/u:o.x2+25/u,n=o.y1>12/u?o.y1-10/u:o.y1+12/u):(t=12/u,n=o.y1>20/u?o.y1-20/u:-60),s(-60===n),Object(r.useEffect)((function(){y(1.5/u)}),[u]),c.a.createElement(ye.Group,{visible:a,x:t,y:n,onMouseEnter:function(){l(b.pointer),p("#E73550"),y(3/u)},onMouseLeave:function(){l(),p("#F9526B"),y(1.5/u)},onClick:function(e){d(),e.cancelBubble=!0}},c.a.createElement(ye.Rect,{x:-5/u,y:-5/u,width:10/u,height:10/u}),c.a.createElement(ye.Line,{points:[-5/u,-5/u,5/u,5/u],stroke:f,strokeWidth:v}),c.a.createElement(ye.Line,{points:[5/u,-5/u,-5/u,5/u],stroke:f,strokeWidth:v}))})),ut={width:800,height:600},st=function(e){var t=e.url,n=void 0===t?"":t,a=e.labelingType,i=e.annotations,o=e.workState,u=e.setWorkState,s=Object(l.b)(),d=Object(r.useCallback)(rt(ut),[ut]),m=Object(r.useState)(ut),g=Object(D.a)(m,2),f=g[0],p=g[1],E=Object(r.useMemo)((function(){return a===y.SingleAnnotation&&1===i.length}),[a,i]),h=Object(r.useState)(b.default),O=Object(D.a)(h,2),j=O[0],C=O[1],S=ke(n,"anonymous"),I=Object(D.a)(S,3),T=I[0],x=I[1],_=I[2],A=Object(r.useState)(null),w=Object(D.a)(A,2),k=w[0],R=w[1],P=Object(r.useState)(!1),L=Object(D.a)(P,2),M=L[0],N=L[1],U=Object(r.useState)(!1),F=Object(D.a)(U,2),G=F[0],z=F[1],B=Object(r.useRef)(1),V=Object(r.useCallback)((function(e){C(e||(E?b.default:b.crosshair))}),[E]),J=Object(r.useCallback)((function(){s(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"REMOVE_ANNOTATION",payload:{index:e}}}(k)),u(v.None),N(!1)}),[s,k,u,N]),H=function(e){R(e),u(v.Selecting)};Object(r.useEffect)((function(){E?(V(),R(0)):V()}),[E,V]),Object(r.useEffect)((function(){o!==v.None||E||R(null)}),[o,E]),Object(r.useEffect)((function(){var e=d(_),t=Object(D.a)(e,2),n=t[0],a=t[1];p(n),B.current=a}),[_,d]);var q="loading"===x||0===f.height&&0===f.width;return c.a.createElement("div",{style:{margin:"0.2em"}},0!==i.length&&M&&!G&&o!==v.Creating?c.a.createElement(ae.a,{iconOnly:!0,text:!0,styles:{color:"#F9526B",":hover":{color:"#E73550"}},content:c.a.createElement(re.CloseIcon,{size:"large"}),onClick:J}):c.a.createElement("div",{style:{height:"2em"}}),c.a.createElement(ye.Stage,{width:f.width,height:f.height,scale:{x:B.current,y:B.current},style:{cursor:j}},c.a.createElement(ye.Layer,{onMouseDown:function(e){var t;E||o===v.Creating||(s((t={x:e.evt.offsetX/B.current,y:e.evt.offsetY/B.current},{type:"CREATE_ANNOTATION",payload:{annotation:it.createWithPoint(t,"")}})),R(i.length-1),u(v.Creating))},onMouseUp:function(e){var t;o===v.Creating&&(s((t={x:e.evt.offsetX/B.current,y:e.evt.offsetY/B.current},{type:"UPDATE_CREATING_ANNOTATION",payload:{updater:function(e){return it.add(t,e)}}})),i.length-1===k?u(v.Selecting):u(v.None))},onDragStart:function(){z(!0)},onDragEnd:function(){z(!1)}},c.a.createElement(ye.Image,{image:T}),!q&&i.map((function(e,t){return c.a.createElement(ye.Group,{key:t},c.a.createElement(lt,{imageSize:f,visible:!G&&o!==v.Creating&&t===k,label:e.label,scale:B.current,changeCursorState:V,setShowOuterRemoveButton:N,removeBox:J}),c.a.createElement(ot,{workState:o,onSelect:H,annotation:e,scale:B.current,annotationIndex:t,selected:t===k,dispatch:s,changeCursorState:V}))})),q&&c.a.createElement(ye.Text,{x:f.width/2-50,y:f.height/2-25,fontSize:50,text:"Loading...",fill:"rgb(255, 0, 0)"}))))},dt=function(e){return console.error(e),{type:"REQUEST_LABEL_IMAGE_FAILURE"}},mt=function(e){return{type:"POST_LABEL_IMAGE_SUCCESS",payload:e}},gt=function(){return function(e){return z()("/api/images/").then((function(t){var n=t.data;e(function(e){return{type:"GET_LABEL_IMAGE_SUCCESS",payload:e}}(n))})).catch((function(t){e(dt(t))}))}},ft=function(e){return function(t){return z()("/api/images/",{method:"POST",data:e}).then((function(e){var n=e.data;t(mt(n))})).catch((function(e){t(dt(e))}))}},pt=function(e,t){return function(n){var a="/api/images/".concat(e,"/");return z()({url:a,method:"PATCH",data:{labels:JSON.stringify(t.map((function(e){return e.label})))}}).then((function(e){var t=e.data;console.info("Save successfully"),n(Et(t.id,t.labels))})).catch((function(e){n(dt(e))}))}},Et=function(e,t){return{type:"UPDATE_LABEL_IMAGE_ANNOTATION",payload:{id:e,labels:t}}},ht=n(255),bt=function(e){var t=e.children,n=e.prevDisabled,a=e.nextDisabled,r=e.onPrevClick,i=e.onNextClick;return c.a.createElement(V.a,{vAlign:"center"},c.a.createElement(ae.a,{text:!0,disabled:n,icon:c.a.createElement(re.ChevronStartIcon,{size:"larger"}),onClick:r}),t,c.a.createElement(ht.a,{content:"Save and Next",trigger:c.a.createElement(ae.a,{text:!0,disabled:a,icon:c.a.createElement(re.ChevronEndIcon,{size:"larger"}),onClick:i})}))},vt=function(e){if(0===e.length)return!1;var t=e[e.length-1].label;return t.x1===t.x2&&t.y1===t.y2},yt=function(e){var t,n,a=e.labelingType,i=e.images,o=e.imageIndex,u=e.closeDialog,s=Object(l.b)(),d=Object(r.useState)(o),m=Object(D.a)(d,2),g=m[0],f=m[1],p=Object(r.useState)(v.None),E=Object(D.a)(p,2),b=E[0],y=E[1],O=Object(l.c)((function(e){return e.labelingPageState.annotations})),j=vt(O),C=null===(t=i[g])||void 0===t?void 0:t.image,S=null===(n=i[g])||void 0===n?void 0:n.id;return Object(r.useEffect)((function(){return"number"===typeof S&&s(function(e){return function(t,n){var a=n().images.find((function(t){return t.id===e})).labels;if(null===a)t(ct([]));else{var r=JSON.parse(a).map((function(e,t){return{id:t,label:e,attribute:"",annotationState:h.Finish}}));t(ct(r))}}}(S)),function(){s({type:"RESET_ANNOTATION"})}}),[s,S]),c.a.createElement(V.a,{column:!0,hAlign:"center"},c.a.createElement(J.a,{size:"larger",weight:"semibold"},"DRAW A RECTANGLE AROUND THE PART"),c.a.createElement(J.a,{size:"larger",styles:{alignSelf:"flex-start"}},g+1),c.a.createElement(bt,{prevDisabled:0===g||b===v.Creating||j,nextDisabled:g===i.length-1||b===v.Creating||j,onPrevClick:function(){s(pt(i[g].id,O)),f((function(e){return(e-1+i.length)%i.length}))},onNextClick:function(){s(pt(i[g].id,O)),f((function(e){return(e+1)%i.length}))}},c.a.createElement(st,{url:null!==C&&void 0!==C?C:"/icons/Play.png",annotations:O,workState:b,setWorkState:y,labelingType:a})),c.a.createElement(V.a,{gap:"gap.medium"},c.a.createElement(ae.a,{primary:!0,content:g===i.length-1?"Save and Done":"Save and Next",disabled:j||b===v.Creating,onClick:function(){s(pt(i[g].id,O)),g===i.length-1&&u(),f((function(e){return(e+1)%i.length}))}}),c.a.createElement(ae.a,{content:"Cancel",onClick:function(){u()}})))},Ot=Object(r.memo)((function(e){var t=e.trigger,n=e.images,a=e.imageIndex,i=e.forceOpen,o=void 0!==i&&i,l=Object(r.useState)(!1),u=Object(D.a)(l,2),s=u[0],d=u[1];return Object(r.useEffect)((function(){d(o)}),[o]),c.a.createElement(Z.a,{trigger:t,styles:{width:"80%"},open:s,onOpen:function(){return d(!0)},content:c.a.createElement(yt,{closeDialog:function(){return d(!1)},labelingType:y.SingleAnnotation,images:n,imageIndex:a})})})),jt=function(e,t){var n=e.id,a=e.label,r=new je.a.Line({points:[a.x1,a.y1,a.x2,a.y1,a.x2,a.y2,a.x1,a.y2,a.x1,a.y1],stroke:"red",strokeWidth:1/t,closed:!0}),c=[];return c.push(new je.a.Circle({x:a.x1,y:a.y1,radius:3/t,fill:"red"})),c.push(new je.a.Circle({x:a.x1,y:a.y2,radius:3/t,fill:"red"})),c.push(new je.a.Circle({x:a.x2,y:a.y2,radius:3/t,fill:"red"})),c.push(new je.a.Circle({x:a.x2,y:a.y1,radius:3/t,fill:"red"})),{id:n,edge:r,points:c}},Ct=Object(r.memo)((function(e){var t=e.labelImage,n=e.labelText,a=void 0===n?"":n,i=e.pointerCursor,o=void 0!==i&&i,l=e.onClick,u=Object(r.useRef)(null),s=Object(r.useRef)(null),d=Object(r.useRef)(null),m=Object(r.useRef)({width:400,height:300}),g=Object(r.useRef)(1),f=Object(r.useRef)([]),p=ke(t.image,"anonymous"),E=Object(D.a)(p,3),b=E[0],v=E[2],y=Object(r.useCallback)(rt(m.current),[m.current]),O=Object(r.useMemo)((function(){return(null===t||void 0===t?void 0:t.labels)?JSON.parse(t.labels).map((function(e,t){return{id:t,label:e,attribute:"",annotationState:h.Finish}})):[]}),[t]);return Object(r.useLayoutEffect)((function(){var e=document.querySelector("#container"),t=e.offsetWidth,n=e.offsetHeight;m.current={width:t,height:n}}),[]),Object(r.useEffect)((function(){if(v.width>0){if(null===s.current){var e=y(v),n=Object(D.a)(e,2),a=n[0],r=n[1];g.current=r,u.current=new je.a.Stage({height:a.height,width:a.width,scale:{x:r,y:r},container:"display-".concat(t.id)}),s.current=new je.a.FastLayer,d.current=new je.a.Image({image:b}),s.current.add(d.current),u.current.add(s.current)}for(var c=O.map((function(e){return jt(e,g.current)})),i=0;i<f.current.length;i++)f.current[i].edge.destroy(),f.current[i].points.forEach((function(e){return e.destroy()}));f.current=c;for(var o=0;o<c.length;o++){var l=c[o],m=l.points,p=l.edge;s.current.add(p);for(var E=0;E<m.length;E++)s.current.add(m[E])}s.current.draw()}}),[v,b,y,t.id,O]),c.a.createElement("div",{onClick:l,id:"container",style:{cursor:o?"pointer":"default",display:"flex",flexFlow:"column",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},c.a.createElement("div",{id:"display-".concat(t.id)}),c.a.createElement(J.a,{align:"center"},a))})),St=n(258),It=c.a.memo((function(e){var t=e.rtsp,n=void 0===t?null:t,a=e.partId,i=e.canCapture,o=e.onVideoStart,u=e.onVideoPause,s=e.setOpenLabelingPage,d=Object(l.b)(),m=Object(r.useState)(""),g=Object(D.a)(m,2),f=g[0],p=g[1],E=Object(r.useState)(0),h=Object(D.a)(E,2),b=h[0],v=h[1],y=function(){p(""),fetch("/api/streams/".concat(f,"/disconnect")).then((function(e){return e.json()})).then((function(e){return console.log(e),null})).catch((function(e){console.error(e)})),u&&u()};Object(r.useEffect)((function(){return window.addEventListener("beforeunload",y),function(){window.removeEventListener("beforeunload",y)}}));var O=f?"/api/streams/".concat(f,"/video_feed"):"";return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{width:"100%",height:"30rem",backgroundColor:"black"}},O?c.a.createElement(H.a,{src:O,styles:{width:"100%",height:"100%",objectFit:"contain"}}):null),c.a.createElement(V.a,{column:!0,hAlign:"center",gap:"gap.small"},c.a.createElement(V.a,{styles:{height:"50px"},hAlign:"center",gap:"gap.large"},c.a.createElement(Tt,{name:"Play",src:"/icons/play-button.png",disabled:null===n,onClick:function(){var e="/api/streams/connect/?part_id=".concat(a,"&rtsp=").concat(n);i||(e+="&inference=1"),fetch(e).then((function(e){return e.json()})).then((function(e){return"ok"===(null===e||void 0===e?void 0:e.status)&&p(e.stream_id),null})).catch((function(e){console.error(e)})),o&&o()}}),i&&c.a.createElement(Tt,{name:"Capture",src:"/icons/screenshot.png",disabled:!f,onClick:function(){d(function(e){return function(){var t=Object(ge.a)(me.a.mark((function t(n){return me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch("/api/streams/".concat(e,"/capture")).then((function(e){return e.json()})).then((function(e){return"ok"===e.status&&(n({type:"ADD_CAPTURED_IMAGE",payload:{newCapturedImage:e.image}}),n(mt(e.image))),null})).catch((function(e){console.error(e)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(f)),0===b&&s(!0)}}),c.a.createElement(Tt,{name:"Stop",src:"/icons/stop.png",disabled:!f,onClick:y})),c.a.createElement(St.a,{checkedValue:b,onCheckedValueChange:function(e,t){v(t.value)},items:[{key:"0",label:"Capture image and label per image",value:0},{key:"1",label:"Capture image and label all later",value:1}]})))})),Tt=function(e){var t=e.src,n=e.name,a=e.disabled,r=void 0!==a&&a,i=e.onClick,o=void 0===i?function(){}:i;return r?c.a.createElement(H.a,{src:t,styles:{height:"100%",filter:"opacity(50%)"}}):c.a.createElement(ht.a,{content:n},c.a.createElement(H.a,{src:t,styles:{height:"100%",cursor:"pointer"},onClick:o}))},xt=function(e){return parseInt(e.split("/")[5],10)},_t=function(e,t){var n=t.partId,a=t.isRelabel,r=void 0!==a&&a;return void 0===n?e:e.filter((function(e){return xt(e.part)===n&&e.is_relabel===r}))},At=function(e){return Array.isArray(e)?e.map((function(e){return{header:e.name,content:{key:e.id}}})):e?{header:e.name,content:{key:e.id}}:null},wt=function(e){var t=e.partId,n=e.goLabelImageIdx,a=e.setGoLabelImageIdx,i=Object(l.b)(),o=Object(r.useState)(null),u=Object(D.a)(o,2),s=u[0],d=u[1],m=Object(r.useState)(!1),g=Object(D.a)(m,2),f=g[0],p=g[1],E=Object(l.c)((function(e){return e.images})),h=_t(E,{partId:t,isRelabel:!1}),b=Object(r.useRef)(h.length);return Object(r.useEffect)((function(){i(gt())}),[i]),Object(r.useEffect)((function(){f&&b.current!==h.length&&(a(h.length-1),p(!1),b.current=h.length)}),[f,h,a]),c.a.createElement(V.a,{gap:"gap.small",styles:{height:"90%",maxHeight:"650px"}},c.a.createElement(V.a,{column:!0,gap:"gap.small",styles:{width:"70%"}},c.a.createElement(kt,{selectedCamera:s,setSelectedCamera:d}),c.a.createElement(It,{rtsp:null===s||void 0===s?void 0:s.rtsp,partId:t,canCapture:!0,setOpenLabelingPage:p})),c.a.createElement(V.a,{column:!0,gap:"gap.small",styles:{width:"30%"}},c.a.createElement(Rt,{partId:t,goLabelImageIdx:n})))},kt=function(e){var t=e.selectedCamera,n=e.setSelectedCamera,a=at(),i=a.map((function(e){return{header:e.name,content:{key:e.id}}}));return Object(r.useEffect)((function(){1===a.length&&n(a[0])}),[a,n]),c.a.createElement(V.a,{gap:"gap.small",vAlign:"center"},c.a.createElement(J.a,null,"Select Camera"),c.a.createElement(nt.a,{items:i,onChange:function(e,t){if(null===t.value)n((function(e){return e}));else{var r=t.value.content.key,c=a.find((function(e){return e.id===r}));c&&n(c)}},value:At(t)}),c.a.createElement(U.b,{to:"/cameras"},"Add Camera"))},Rt=function(e){var t=e.goLabelImageIdx,n=e.partId,a=Object(l.c)((function(e){return e.images})),r=_t(a,{partId:n,isRelabel:!1}),i=r.filter((function(e){return e.labels})).length>=15,o=r.length;return c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,null,"Total: ",o),!i&&c.a.createElement(J.a,{error:!0},"*Please capture and label more then 15 images"),c.a.createElement(Q.a,{columns:"2",styles:{border:"1px solid grey",height:"40rem",gridGap:"10px",padding:"10px",borderColor:i?"":"red",justifyItems:"center",alignItems:"center",overflow:"scroll"}},r.map((function(e,n,a){return c.a.createElement("div",{key:e.id,style:{height:"100%",width:"100%"}},c.a.createElement("span",null,n+1),c.a.createElement(Ot,{key:n,imageIndex:n,images:a,forceOpen:t===n,trigger:c.a.createElement("div",{style:{height:150,width:200}},c.a.createElement(Ct,{labelImage:e,pointerCursor:!0})),isRelabel:!1}))}))),c.a.createElement(B.a,{when:o<15,message:"The count of images is less than 15, which may cause error when configure part identification. Sure you want to leave?"}))},Pt=function(e){var t=e.partId,n=Object(l.b)(),a=Object(l.c)((function(e){return e.images})),i=_t(a,{partId:t,isRelabel:!1}),o=i.filter((function(e){return e.labels})).length>=15;return Object(r.useEffect)((function(){n(gt())}),[n]),c.a.createElement(V.a,{gap:"gap.smaller",column:!0},c.a.createElement("input",{type:"file",onChange:function(e){for(var a=0;a<e.target.files.length;a++){var r=new FormData;r.append("image",e.target.files[a]),r.append("part","/api/parts/".concat(t,"/")),n(ft(r))}},accept:"image/*",multiple:!0}),c.a.createElement(Lt,{capturedImages:i,isValid:o,partId:t}))},Lt=function(e){var t=e.capturedImages,n=e.isValid;e.partId;return c.a.createElement(c.a.Fragment,null,!n&&c.a.createElement(J.a,{error:!0},"*Please capture and label more then 15 images"),c.a.createElement(Q.a,{columns:"6",styles:{border:"1px solid grey",gridGap:"10px",padding:"10px",borderColor:n?"":"red",justifyItems:"center",alignItems:"center",overflow:"scroll"}},t.map((function(e,t,n){return c.a.createElement(Ot,{key:t,imageIndex:t,images:n,trigger:c.a.createElement(Ct,{labelImage:e,pointerCursor:!0}),isRelabel:!1})}))))},Mt=function(e){var t=e.onConfirm,n=void 0===t?null:t,a=e.onCancel,r=void 0===a?null:a,i=e.trigger,o=e.contentText,l=e.cancelButton,u=void 0===l?"Cancel":l,s=e.confirmButton,d=void 0===s?"Confirm":s,m=e.open,g=void 0===m?void 0:m;return c.a.createElement(Z.a,{styles:{display:"flex",flexDirection:"column",alignItems:"center"},cancelButton:u,confirmButton:d,onConfirm:n,onCancel:r,open:g,content:c.a.createElement(c.a.Fragment,null,c.a.createElement(V.a,{hAlign:"center",column:!0},c.a.createElement(re.ExclamationCircleIcon,{size:"largest",styles:function(e){return{color:e.theme.siteVariables.colorScheme.brand.foreground}}}),c.a.createElement("div",null,o))),trigger:i})},Nt={siteVariables:{colors:{brand:{50:"#f3fafd",100:"#d1ecf9",200:"#aadcf4",300:"#5dbce8",400:"#1ba0dd",500:"#0094d8",600:"#0085c3",700:"#0071a5",800:"#005379",900:"black"}},colorScheme:{brand:{foreground:"#0094d8",background:"#0094d8",border:"#E1DFDD",shadow:"#000",foregroundHover:"#0094d8",backgroundHover:"#0085c3",borderHover:"#5dbce8",shadowHover:"#000",foregroundActive:"#0094d8",backgroundActive:"#0094d8",borderActive:"#E1DFDD",shadowActive:void 0,foregroundFocus:"#0094d8",backgroundFocus:"#0094d8",borderFocus:"#000",shadowFocus:void 0,foregroundPressed:"#0071a5",backgroundPressed:"#0071a5",borderPressed:"#5dbce8",shadowPressed:void 0,foregroundDisabled:"#C8C6C4",backgroundDisabled:"#EDEBE9",borderDisabled:"#EDEBE9",shadowDisabled:void 0,foreground1:"#0094d8",foreground2:"#0085c3",foreground3:"#aadcf4",foreground4:"#fff",background1:"#d1ecf9",background2:"#005379",background3:"#373644",background4:"#0071a5",border1:"#aadcf4",border2:"#5dbce8",foregroundHover1:"#fff",foregroundHover2:"#aadcf4",backgroundHover1:"#f3fafd",foregroundPressed1:"#fff",foregroundActive1:"#0094d8",foregroundActive2:"#aadcf4",backgroundActive1:"#0094d8",borderActive1:"#aadcf4",borderActive2:"#5dbce8",foregroundFocus1:"#0094d8",foregroundFocus2:"#0085c3",foregroundFocus3:"#aadcf4",foregroundFocus4:"#fff",backgroundFocus1:"#d1ecf9",backgroundFocus2:"#005379",backgroundFocus3:"#373644",borderFocusWithin:"#fff",borderFocus1:"#0094d8",foregroundDisabled1:"#C8C6C4",backgroundDisabled1:"#EDEBE9"}}}},Dt=Object(re.mergeThemes)(re.themes.teams,Nt),Ut=Object(re.mergeThemes)(Dt,{siteVariables:{colorScheme:{brand:{foreground:"#C4314B",background:"#C4314B",foregroundHover:"#A72037",backgroundHover:"#A72037",foregroundActive:"#8E192E",backgroundActive:"#8E192E",foregroundPressed:"#8E192E",backgroundPressed:"#8E192E"}}}});!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.Success=2]="Success",e[e.Failed=3]="Failed"}(Ke||(Ke={}));var Ft=function(e){var t=e.status,n=void 0===t?Ke.None:t,a=e.errorMessage,r=void 0===a?"":a,i=e.onConfirm,o=void 0===i?function(){}:i;return c.a.createElement(Z.a,{styles:{display:"flex",flexDirection:"column",alignItems:"center"},confirmButton:n!==Ke.Loading&&"Confirm",onConfirm:o,open:n!==Ke.None,content:c.a.createElement(c.a.Fragment,null,c.a.createElement(V.a,{hAlign:"center",column:!0},function(){switch(n){case Ke.Loading:return c.a.createElement(Ne.a,{label:"Loading",size:"largest"});case Ke.Failed:return c.a.createElement(c.a.Fragment,null,c.a.createElement(re.ErrorIcon,{size:"largest"}),c.a.createElement(J.a,{error:!0},r));case Ke.Success:return c.a.createElement(c.a.Fragment,null,c.a.createElement(re.AcceptIcon,{size:"largest",style:{color:"green"}}),c.a.createElement(J.a,{success:!0},"Success"));default:return null}}()))})},Gt=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e.project}));return Object(r.useEffect)((function(){t(ze(e))}),[t,e]),n},zt=function(){var e=He().get("partId"),t=Object(r.useState)(null),n=Object(D.a)(t,2),a=n[0],i=n[1],o=Object(r.useState)(""),l=Object(D.a)(o,2),u=l[0],s=l[1],d=Object(r.useState)(""),m=Object(D.a)(d,2),g=m[0],f=m[1],p=Object(r.useState)(""),E=Object(D.a)(p,2),h=E[0],b=E[1],v=Object(B.h)(),y=Object(r.useState)(Ke.None),O=Object(D.a)(y,2),j=O[0],C=O[1],S=Gt(!1),I=function(){var t=Object(ge.a)(me.a.mark((function t(){return me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return C(Ke.Loading),t.prev=1,t.next=4,z.a.get("/api/projects/".concat(S.data.id,"/delete_tag?part_name=").concat(u));case 4:return t.next=6,z.a.delete("/api/parts/".concat(e,"/"));case 6:C(Ke.Success),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),b(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return c.a.createElement(Q.a,{columns:"68% 30%",rows:"80px auto 30px",styles:{gridColumnGap:"20px",height:"100%"}},e?c.a.createElement(Jt,{partId:e}):null,c.a.createElement(Bt,{partId:e,name:u,setName:s,description:g,setDescription:f}),c.a.createElement(V.a,{column:!0,gap:"gap.small",styles:{gridColumn:"1 / span 2"}},c.a.createElement(Vt,{partId:e,goLabelImageIdx:a,setGoLabelImageIdx:i})),c.a.createElement(V.a,{styles:{gridColumn:"2 / span 1"},hAlign:"center",vAlign:"center",gap:"gap.small"},c.a.createElement(ae.a,{content:"Save",primary:!0,onClick:function(){z()({method:"PUT",url:"/api/parts/".concat(e,"/"),data:{name:u,description:g}}).then((function(){v.push("/parts/")})).catch((function(e){b(JSON.stringify(e.response.data))}))},disabled:!u}),c.a.createElement(F.a,{theme:Ut},c.a.createElement(Mt,{contentText:c.a.createElement("p",null,"Sure you want to delete the part ",c.a.createElement("b",null,u),"?"),trigger:c.a.createElement(ae.a,{content:"Delete",primary:!0}),onConfirm:I})),c.a.createElement(Ft,{status:j,onConfirm:function(){j===Ke.Success&&v.push("/parts/")}}),!!h&&c.a.createElement(be.a,{danger:!0,content:h,dismissible:!0})))},Bt=function(e){var t=e.partId,n=e.name,a=e.setName,i=e.description,o=e.setDescription;return Object(r.useEffect)((function(){t&&z.a.get("/api/parts/".concat(t,"/")).then((function(e){var t=e.data;a(t.name),o(t.description)})).catch((function(e){console.error(e)}))}),[t,o,a]),c.a.createElement("div",{style:{display:"flex",flexFlow:"column",justifyContent:"space-between"}},c.a.createElement(ee.a,{placeholder:"Enter Part Name...",fluid:!0,value:n,onChange:function(e,t){a(t.value)}}),c.a.createElement(ee.a,{placeholder:"Enter Description...",fluid:!0,value:i,onChange:function(e,t){o(t.value)}}))},Vt=function(e){var t=e.partId,n=e.goLabelImageIdx,a=e.setGoLabelImageIdx;return c.a.createElement(B.e,null,c.a.createElement(B.c,{path:"/parts/detail/capturePhotos"},c.a.createElement(wt,{partId:parseInt(t,10),goLabelImageIdx:n,setGoLabelImageIdx:a})),c.a.createElement(B.c,{path:"/parts/detail/uploadPhotos"},c.a.createElement(Pt,{partId:parseInt(t,10)})))},Jt=function(e){var t=e.partId,n=[{key:"uploadPhotos",as:U.b,to:"/parts/detail/uploadPhotos?partId=".concat(t),content:"Upload Photos"},{key:"capturePhotos",as:U.b,to:"/parts/detail/capturePhotos?partId=".concat(t),content:"Capture Photo"}],a=Object(B.i)().pathname,r=n.findIndex((function(e){return e.to.split("?")[0]===a}));return c.a.createElement("div",null,c.a.createElement(tt.a,{items:n,activeIndex:r,pointing:!0,primary:!0}))},Ht=function(e){return console.error(e),alert(e),{type:"REQUEST_LOCATION_FAILURE"}},qt=function(e){return function(t){return z()("/api/locations/",{method:"POST",data:e}).then((function(e){var n=e.data;t(function(e){return{type:"POST_LOCATION_SUCCESS",payload:e}}(n))})).catch((function(e){t(Ht(e))}))}},Wt=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.locations.filter((function(e){return!e.is_demo}))}));return Object(r.useEffect)((function(){e((function(e){return z()("/api/locations/").then((function(t){var n=t.data;e(function(e){return{type:"GET_LOCATION_SUCCESS",payload:e}}(n))})).catch((function(t){e(Ht(t))}))}))}),[e]),c.a.createElement("div",{style:{display:"flex",flexFlow:"column",justifyContent:"space-between",padding:"3em",height:"100%"}},c.a.createElement(Q.a,{columns:"8",styles:{height:"75%"}},t.map((function(e,t){return c.a.createElement(q,{key:t,to:"/locations/detail?name=".concat(e.name),defaultSrc:"/icons/defaultLocation.png",width:"6.25em",height:"6.25em",label:e.name})}))),c.a.createElement("div",{style:{alignSelf:"flex-end"}},c.a.createElement(ie,{header:"Add Location",fields:[{placeholder:"Location Name",key:"name",type:"input",required:!0},{placeholder:"Description",key:"description",type:"textArea",required:!1}],onConfirm:function(t){var n=t.name,a=t.description;e(qt({name:n,description:a,is_demo:!1}))}})))},Qt=n(246),Kt=function(){var e=He().get("name"),t=Object(l.c)((function(t){return t.locations.find((function(t){return t.name===e}))}));return c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,{size:"larger",weight:"semibold"},"Details"),c.a.createElement(Qt.a,{color:"black"}),c.a.createElement(Q.a,{columns:"15% 3fr 2fr",styles:{height:"60%"}},c.a.createElement(V.a,{column:!0,gap:"gap.large"},c.a.createElement(q,{defaultSrc:"/icons/defaultLocation.png",width:"6.25em",height:"6.25em"}),c.a.createElement(J.a,null,"Description:")),c.a.createElement(V.a,{column:!0,gap:"gap.large"},c.a.createElement(J.a,{styles:{paddingTop:"0.625em",minHeight:"6.25em"}},t.name),c.a.createElement(J.a,{styles:{height:"60%"}},t.description))))},Yt=n(280),Xt=n(277),$t=n(380),Zt=(n(952),n(953),Object(r.memo)((function(e){var t=e.confidenceLevel,n=e.relabelImages,a=e.imageIndex,i=e.setJudgedImageList,o=e.partId,l=e.partItems,u=e.isPartCorrect,s=Object(r.useMemo)((function(){return[{header:"No Object",content:{key:null}}].concat(Object(C.a)(l.filter((function(e){return e.content.key!==o}))))}),[o,l]),d=Object(r.useState)(s[0]),m=Object(D.a)(d,2),g=m[0],f=m[1];return Object(r.useEffect)((function(){i([]),f(s[0])}),[s,f,i]),c.a.createElement("div",{style:{minHeight:"16em",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement(Ot,{imageIndex:a,images:n,isRelabel:!0,trigger:c.a.createElement("div",{style:{padding:"0.5em",height:"96%",flex:"1 0 0"}},c.a.createElement(Ct,{pointerCursor:!0,labelImage:n[a]}))}),c.a.createElement("div",{style:{height:"96%",maxHeight:"10em",flex:"1 0 0",display:"flex",flexFlow:"column",justifyContent:"center"}},c.a.createElement(J.a,{truncated:!0},"Confidence Level: ",c.a.createElement("b",null,t,"%")),c.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"50%",padding:"0.2em"}},c.a.createElement(St.a,{checkedValue:u,onCheckedValueChange:function(e,t){i((function(e){var r=Object(C.a)(e);if(1===t.value){var c=r.findIndex((function(e){return e.imageId===n[a].id}));c>=0?r[c]=Object(S.a)({},r[c],{partId:o}):r.push({imageId:n[a].id,partId:o})}else if(0===t.value){var i=r.findIndex((function(e){return e.imageId===n[a].id}));i>=0?r[i]=Object(S.a)({},r[i],{partId:null}):r.push({imageId:n[a].id,partId:null})}return r}))},items:[{key:"1",label:"Yes",value:1},{key:"0",label:"No",value:0}]}),0===u&&s.length>0&&c.a.createElement("div",{style:{width:"50%"}},c.a.createElement(nt.a,{fluid:!0,items:s,onChange:function(e,t){var r=t.value;null!==r&&(f(r),i((function(e){var t=Object(C.a)(e),c=t.findIndex((function(e){return e.imageId===n[a].id}));if(-1===c)throw new Error("Image id doesn't match");return t[c]=Object(S.a)({},t[c],{partId:r.content.key}),t})))},value:g})))))}))),en=Object(r.memo)((function(e){var t=e.images,n=e.judgedImageList,a=e.setJudgedImageList,r=e.selectedPartId,i=e.partItems;return c.a.createElement(Q.a,{columns:"2",styles:{width:"100%",height:"80%",overflow:"scroll",borderWidth:"0.0625em",borderStyle:"solid"}},t.filter((function(e){return e.display})).map((function(e,t,o){if(e.display){var l=null,u=n.findIndex((function(t){return t.imageId===e.id}));return u>=0&&(l=n[u].partId===r?1:0),c.a.createElement(Zt,{key:e.id,confidenceLevel:e.confidenceLevel,imageIndex:t,relabelImages:o,isPartCorrect:l,setJudgedImageList:a,partId:r,partItems:i})}})))})),tn=function(){var e,t,n=Object(B.h)(),a=Object(l.b)(),i=Object(l.c)((function(e){return{projectData:e.project.data,images:e.images}})),o=i.projectData,u=i.images,s=se(!1),d=Object(r.useMemo)((function(){return 0===s.length||0===o.parts.length?[]:o.parts.reduce((function(e,t){var n=s.find((function(e){return e.id===t}));return n?(e.push({header:n.name,content:{key:n.id}}),e):e}),[])}),[s,o]),m=Object(r.useState)(null),g=Object(D.a)(m,2),f=g[0],p=g[1],E=null!==(e=null===(t=null===f||void 0===f?void 0:f.content)||void 0===t?void 0:t.key)&&void 0!==e?e:null,h=Object(r.useState)([o.accuracyRangeMin,o.accuracyRangeMax]),b=Object(D.a)(h,2),v=b[0],y=b[1],O=Object(r.useState)(!1),j=Object(D.a)(O,2),I=j[0],T=j[1],x=Object(r.useRef)({sorted:!1,prevIsAscend:!1}),_=Object(r.useState)([]),A=Object(D.a)(_,2),w=A[0],k=A[1],R=Object(r.useState)([]),P=Object(D.a)(R,2),L=P[0],M=P[1];Object(r.useEffect)((function(){a(ze(!1)),a(gt())}),[a]),Object(r.useEffect)((function(){return M(_t(u,{partId:E,isRelabel:!0}).map((function(e){var t=(1e3*e.confidence|0)/10;return Object(S.a)({},e,{confidenceLevel:t,display:t>=v[0]&&t<=v[1]})}))),function(){T(!1),x.current={sorted:!1,prevIsAscend:!1}}}),[v,u,E]),Object(r.useEffect)((function(){x.current.sorted?x.current.prevIsAscend!==I&&(M((function(e){var t=Object(C.a)(e);return t.reverse(),t})),x.current.prevIsAscend=I):(M((function(e){return I?e.sort((function(e,t){return e.confidenceLevel-t.confidenceLevel})):e.sort((function(e,t){return t.confidenceLevel-e.confidenceLevel})),Object(C.a)(e)})),x.current={sorted:!0,prevIsAscend:!0})}),[I]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,{size:"larger",weight:"semibold"},"Manual Identification"),c.a.createElement(Qt.a,{color:"black"}),c.a.createElement(V.a,{column:!0,gap:"gap.medium",space:"between",styles:{height:"75vh",padding:"1em"}},c.a.createElement(Q.a,{columns:"3",styles:{columnGap:"1em",justifyItems:"center"}},c.a.createElement(V.a,{vAlign:"center",gap:"gap.smaller"},c.a.createElement(J.a,{truncated:!0},"Select Part:"),c.a.createElement(nt.a,{items:d,onChange:function(e,t){var n=t.value;null!==n&&p(n)},value:f})),c.a.createElement(V.a,{vAlign:"center",gap:"gap.smaller",styles:{width:"80%"}},c.a.createElement(J.a,null,"Confidence Level:"),c.a.createElement("div",{style:{width:"70%"}},c.a.createElement($t.b,{value:v,allowCross:!1,onChange:y,handle:function(e){var t=e.value,n=e.dragging,a=e.index,r=Object(Yt.a)(e,["value","dragging","index"]);return c.a.createElement(Xt.a,{prefixCls:"rc-slider-tooltip",overlay:"".concat(t,"%"),visible:n,placement:"top",key:a},c.a.createElement($t.a,Object.assign({value:t},r)))}}))),c.a.createElement(V.a,{vAlign:"center"},c.a.createElement(J.a,{truncated:!0},"Sort:"),c.a.createElement(ae.a,{icon:I?c.a.createElement(re.ArrowDownIcon,null):c.a.createElement(re.ArrowUpIcon,null),styles:{color:x.current.sorted?"#0094d8":"grey"},text:!0,iconOnly:!0,onClick:function(){T((function(e){return!e}))}}))),c.a.createElement("div",{style:{display:"flex",minWidth:"20em",maxWidth:"20%",justifyContent:"space-around"}},c.a.createElement(ae.a,{primary:!0,content:"Yes to all",onClick:function(){k(L.map((function(e){return{imageId:e.id,partId:E}})))}}),c.a.createElement(ae.a,{styles:{backgroundColor:"#E97548",color:"white",":hover":{backgroundColor:"#CC4A31",color:"white"}},content:"No to remaining",onClick:function(){k((function(e){return L.map((function(t){var n=e.find((function(e){return e.imageId===t.id}));return null!==n&&void 0!==n?n:{imageId:t.id,partId:null}}))}))}})),c.a.createElement(en,{images:L,judgedImageList:w,setJudgedImageList:k,selectedPartId:E,partItems:d}),c.a.createElement(ae.a,{content:"Update",styles:{width:"15%"},primary:!0,disabled:0===w.length,onClick:function(){z()({method:"POST",url:"/api/relabel/update",data:w}).then((function(){var e=w.map((function(e){return e.imageId}));L.every((function(t){return e.includes(t.id)}))&&n.push("/partIdentification"),a(gt()),k([])})).catch((function(e){console.error(e)}))}})))},nn=function(){var e=Object(r.useState)([]),t=Object(D.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){var e=z.a.get("/api/parts/"),t=z.a.get("/api/images/");z.a.all([e,t]).then(z.a.spread((function(){var e=arguments.length<=0?void 0:arguments[0],t=e.data,n=arguments.length<=1?void 0:arguments[1],r=n.data;a(t.map((function(e){var t;return Object(S.a)({},e,{images:null===(t=r.find((function(t){return xt(t.part)===e.id})))||void 0===t?void 0:t.image})})))}))).catch((function(e){return console.error(e)}))}),[]),c.a.createElement("div",{style:{position:"relative",height:"100%"}},c.a.createElement(V.a,{gap:"gap.large",wrap:!0},n.filter((function(e){return!e.is_demo})).map((function(e){return c.a.createElement(an,{key:e.id,src:e.images,id:e.id,name:e.name})}))),c.a.createElement("div",{style:{position:"absolute",right:"100px",bottom:"100px"}},c.a.createElement(ie,{header:"Add Part",fields:[{placeholder:"Part Name",key:"name",type:"input",required:!0},{placeholder:"Description",key:"description",type:"textArea",required:!1}],onConfirm:function(e){var t=e.name,n=e.description;z()({method:"POST",url:"/api/parts/",data:{name:t,description:n}}).then((function(e){var t=e.data;a((function(e){return e.concat(t)}))})).catch((function(e){throw e.response?new Error(e.response.data.log):e.request?new Error(e.request):e})).catch((function(e){alert(e)}))}})))},an=function(e){var t=e.src,n=e.id,a=e.name;return c.a.createElement(V.a,{column:!0,hAlign:"center",gap:"gap.large",as:U.b,to:"/parts/detail/capturePhotos?partId=".concat(n)},c.a.createElement("div",{style:{width:"250px",height:"250px"}},c.a.createElement(H.a,{src:t,styles:{width:"100%",height:"100%",objectFit:"cover"}})),c.a.createElement(J.a,{size:"larger"},a))},rn=n(975),cn=n(973),on=null,ln=null,un={reactPlugin:on,appInsights:ln,initialize:function(e,t,n){if(!n)throw new Error("Could not initialize Telemetry Service");if(!e)throw new Error("Instrumentation key not provided in /src/components/TelemetryProvider.tsx");on=new cn.a,(ln=new rn.a({config:{instrumentationKey:e,maxBatchInterval:0,disableFetchTracking:!1,disableTelemetry:!t,extensions:[on],extensionConfig:Object($.a)({},on.identifier,{history:n})}})).loadAppInsights()}},sn=function(){return ln},dn=function(){var e=Object(l.b)();return c.a.createElement(ie,{header:"Add Camera",fields:[{placeholder:"Name",key:"name",type:"input",required:!0},{placeholder:"RTSP URL",key:"rtsp",type:"input",required:!0}],trigger:c.a.createElement("p",{style:{textDecoration:"underline",cursor:"pointer"}},"Add Camera"),onConfirm:function(t){var n=t.name,a=t.rtsp;e(X({name:n,rtsp:a,is_demo:!1})).then((function(){return window.location.reload()})).catch(alert)}})},mn=function(){var e=Object(l.b)();return c.a.createElement(ie,{header:"Add Location",fields:[{placeholder:"Location Name",key:"name",type:"input",required:!0},{placeholder:"Description",key:"description",type:"textArea",required:!1}],trigger:c.a.createElement("p",{style:{textDecoration:"underline",cursor:"pointer"}},"Add Location"),onConfirm:function(t){var n=t.name,a=t.description;e(qt({name:n,description:a,is_demo:!1})).then((function(){return window.location.reload()})).catch((function(e){return alert(e)}))}})},gn=function(){return c.a.createElement(ie,{trigger:c.a.createElement("p",{style:{textDecoration:"underline",cursor:"pointer"}},"Add Part"),header:"Add Part",fields:[{placeholder:"Part Name",key:"name",type:"input",required:!0},{placeholder:"Description",key:"description",type:"textArea",required:!1}],onConfirm:function(e){var t=e.name,n=e.description;z()({method:"POST",url:"/api/parts/",data:{name:t,description:n}}).then((function(){return window.location.reload()})).catch((function(e){alert(e)}))}})},fn=function(){var e=Object(ge.a)(me.a.mark((function e(t){var n,a,r,c,i;return me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.a.get("/api/images/");case 2:n=e.sent,a=n.data,r=t.map((function(e){return e.id})),c=a.filter((function(e){return r.includes(xt(e.part))})).length,(i=sn())&&i.trackEvent({name:"train",properties:{images:c,parts:t.length,source:""}});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pn=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.project})),n=t.isLoading,a=t.error,i=t.data,o=i.id,u=i.camera,s=i.location,d=i.parts,m=i.needRetraining,g=i.accuracyRangeMin,f=i.accuracyRangeMax,p=i.maxImages,E=i.sendMessageToCloud,h=i.framesPerMin,b=i.accuracyThreshold,v=Object(l.c)((function(e){return e.images})),y=Object(r.useState)(!1),O=Object(D.a)(y,2),j=O[0],C=O[1],S=hn("cameras",j),I=Object(D.a)(S,4),T=I[0],x=I[1],_=I[2],A=I[3],w=hn("parts",j,!0),k=Object(D.a)(w,4),R=k[0],P=k[1],L=k[2],M=k[3],N=hn("locations",j),U=Object(D.a)(N,4),F=U[0],G=U[1],z=U[2],H=U[3],q=Object(B.h)(),W=Object(r.useState)(!1),Q=Object(D.a)(W,2),K=Q[0],Y=Q[1],X=Object(r.useState)({min:0,max:0,partName:"",rangeMessage:""}),Z=Object(D.a)(X,2),te=Z[0],ne=Z[1];Object(r.useEffect)((function(){T||R||F||e(ze(j))}),[e,T,F,R,j]),Object(r.useEffect)((function(){e(gt())}),[e]),Object(r.useEffect)((function(){j||(s&&H(s),d.length&&M(d),u&&A(u))}),[u,j,s,d,A,H,M]);var re=function(){var t=Object(ge.a)(me.a.mark((function t(){return me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,j||fn(L),t.next=4,e(Be(o,z,L,_,j));case 4:"undefined"!==typeof t.sent&&q.push("/cameras/detail?name=".concat(_.name,"&isDemo=").concat(j)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),alert(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),ce=function(t,n){e(Ge(Object($.a)({},t,n)))};Object(r.useEffect)((function(){var e=v.reduce((function(e,t){var n=xt(t.part),a=e.findIndex((function(e){return e.id===n}));return a>=0&&(e[a].length=e[a].length+1||1),e}),L).reduce((function(e,t){return t.length<e.length?{name:t.name,length:t.length}:e}),{name:"",length:1/0});e.length!==1/0&&(e.length<30?ne({min:10,max:40,partName:e.name,rangeMessage:"lower than 30"}):e.length>=30&&e.length<80?ne({min:30,max:60,partName:e.name,rangeMessage:"between 30 to 80"}):e.length>=80&&e.length<130?ne({min:50,max:80,partName:e.name,rangeMessage:"between 80 to 130"}):e.length>=130&&ne({min:60,max:90,partName:e.name,rangeMessage:"more than 130"}))}),[g,e,v,L]);var ie=!m||j,oe=!E;return c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,{size:"larger",weight:"semibold"},"Part Identification"),c.a.createElement(Qt.a,{color:"black"}),a&&c.a.createElement(be.a,{danger:!0,header:"Load Part Identification Error",content:"".concat(a.name,": ").concat(a.message)}),c.a.createElement(V.a,{column:!0,gap:"gap.large",design:{paddingTop:"30px"}},c.a.createElement(bn,{moduleName:"camera",to:"/cameras",value:_,setSelectedModuleItem:A,items:x,isMultiple:!1}),c.a.createElement(bn,{moduleName:"parts",to:"/parts",value:L,setSelectedModuleItem:M,items:P,isMultiple:!0}),c.a.createElement(bn,{moduleName:"location",to:"/locations",value:z,setSelectedModuleItem:H,items:G,isMultiple:!1,isTestModel:j}),c.a.createElement(V.a,{gap:"gap.large"},c.a.createElement(V.a,{column:!0,gap:"gap.medium"},c.a.createElement(ve.a,{label:"Set up retraining",checked:m,onChange:function(e,t){var n=t.checked;return ce("needRetraining",n)},disabled:j}),c.a.createElement(J.a,{disabled:ie},"Capture Image"),c.a.createElement(J.a,{disabled:ie},"Minimum:"," ",c.a.createElement(ee.a,{type:"number",disabled:ie,inline:!0,value:g,onChange:function(e,t){var n=t.value;return ce("accuracyRangeMin",n)}}),"%"),c.a.createElement(J.a,{disabled:ie},"Maximum:"," ",c.a.createElement(ee.a,{type:"number",disabled:ie,inline:!0,value:f,onChange:function(e,t){var n=t.value;return ce("accuracyRangeMax",n)}}),"%"),c.a.createElement(J.a,{styles:{fontSize:"12px"},success:!0},"The Part ".concat(te.partName," contains images ").concat(te.rangeMessage,", recommend to set the range to Min ").concat(te.min,"% and Max ").concat(te.max,"% ")),c.a.createElement(J.a,{disabled:ie},"Maximum Images to Store:"," ",c.a.createElement(ee.a,{type:"number",disabled:ie,inline:!0,value:p,onChange:function(e,t){var n=t.value;Y(n<15),ce("maxImages",n)}}),K&&c.a.createElement(J.a,{error:!0},"Cannot be less than 15"))),c.a.createElement(V.a,{column:!0,gap:"gap.medium"},c.a.createElement(ve.a,{label:"Send message to cloud",checked:E,onChange:function(e,t){var n=t.checked;return ce("sendMessageToCloud",n)}}),c.a.createElement(J.a,{disabled:oe},"Frames per minute:"," ",c.a.createElement(ee.a,{type:"number",disabled:oe,inline:!0,value:h,onChange:function(e,t){var n=t.value;return ce("framesPerMin",n)}})),c.a.createElement(J.a,{disabled:oe},"Accuracy threshold:"," ",c.a.createElement(ee.a,{type:"number",disabled:oe,inline:!0,value:b,onChange:function(e,t){var n=t.value;return ce("accuracyThreshold",n)}})))),c.a.createElement(V.a,{gap:"gap.large"},c.a.createElement(ae.a,{content:"Configure",primary:!0,onClick:re,disabled:(!_||!z||!L||n)&&!j,loading:n}),c.a.createElement(En,{isTestModel:j,setIsTestModel:C}))))},En=function(e){var t=e.isTestModel,n=e.setIsTestModel;return t?c.a.createElement(ae.a,{content:"Back",onClick:function(){return n(!1)},primary:!0}):c.a.createElement(Mt,{confirmButton:"Confirm",onConfirm:function(){return n(!0)},contentText:c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,'"Demo Pretrained Detection" is for seeing inference result, no retraining experience here.'),c.a.createElement("p",null,"For retraining experience, please create a new model")),trigger:c.a.createElement(ae.a,{content:"Demo Pretrained Detection",primary:!0})})};function hn(e,t,n){var a=Object(r.useRef)([]),c=Object(r.useState)([]),i=Object(D.a)(c,2),o=i[0],l=i[1],u=Object(r.useState)(n?[]:null),s=Object(D.a)(u,2),d=s[0],m=s[1],g=Object(r.useState)(!0),f=Object(D.a)(g,2),p=f[0],E=f[1];return Object(r.useEffect)((function(){var r="cameras"===e&&t?"/api/".concat(e,"/"):"/api/".concat(e,"/?is_demo=").concat(Number(t));E(!0),z()(r).then((function(t){var r=t.data;0===r.length?l([{header:"No ".concat(e.replace("s","")," found, please add ").concat(e.replace("s","")),content:{key:"Dummy"}}]):l(r.map((function(e){return{header:e.name,content:{key:e.id}}}))),a.current=r,m(n?r:r[0]),E(!1)})).catch((function(e){return console.error(e)})).finally((function(){return E(!1)}))}),[n,e,t]),[p,o,d,Object(r.useCallback)((function(e){if(Array.isArray(e)){var t=e.reduce((function(e,t){var n=a.current.find((function(e){return e.id.toString(10)===t.toString()}));return n&&e.push(n),e}),[]);m(t)}else{var n=a.current.find((function(t){return t.id.toString(10)===e.toString()}));n&&m(n)}}),[])]}var bn=function(e){var t=e.moduleName,n=(e.to,e.value),a=e.setSelectedModuleItem,r=e.items,i=e.isMultiple,o=e.isTestModel;return c.a.createElement(V.a,{vAlign:"center",gap:"gap.medium"},c.a.createElement(J.a,{styles:{width:"150px"}},"Select ".concat(t)),o?c.a.createElement(nt.a,{items:r,value:At(n),multiple:i,open:!1}):c.a.createElement(nt.a,{items:r,onChange:function(e,t){if(null!==t.value)if(Array.isArray(t.value)){var n=t.value.map((function(e){return e.content.key}));a(n)}else{var r=t.value.content.key;a(r)}},value:At(n),multiple:i}),function(){switch(t){case"camera":return c.a.createElement(dn,null);case"location":return c.a.createElement(mn,null);case"parts":return c.a.createElement(gn,null);default:return c.a.createElement("p",null,"Un supported module")}}())},vn=function(e){return{type:"REQUEST_SUCCESS",payload:e}},yn=function(e){return{type:"REQUEST_FAIL",error:e}},On=function(){return function(e){return e({type:"REQUEST_START"}),z.a.get("/api/settings/").then((function(t){var n=t.data;return n.length>0&&e(vn({loading:!1,error:null,current:{id:n[0].id,key:n[0].training_key,namespace:n[0].endpoint},origin:{id:n[0].id,key:n[0].training_key,namespace:n[0].endpoint},isTrainerValid:n[0].is_trainer_valid,appInsightHasInit:n[0].app_insight_has_init})),n[0].is_collect_data})).catch((function(t){e(yn(t))}))}},jn=function(){return function(e,t){e({type:"GET_ALL_CV_PROJECTS_REQUEST"});var n=t().setting.current.id;return z.a.get("/api/settings/".concat(n,"/list_projects")).then((function(t){var n=t.data;e({type:"GET_ALL_CV_PROJECTS_SUCCESS",pyload:n})})).catch((function(e){throw e.response?new Error(e.response.data.log):e.request?new Error(e.request):e})).catch((function(t){e({type:"GET_ALL_CV_PROJECTS_ERROR",error:t})}))}},Cn=function(){var e=Object(l.c)((function(e){return e.setting})),t=e.loading,n=e.error,a=e.current,i=e.origin,o=e.isTrainerValid,u=e.cvProjects,s=e.appInsightHasInit,d=Object(l.b)(),m=Object(r.useState)(!1),g=Object(D.a)(m,2),f=g[0],p=g[1],E=Object(r.useState)(!1),h=Object(D.a)(E,2),b=h[0],v=h[1],y=Object(r.useState)(null),O=Object(D.a)(y,2),j=O[0],C=O[1],I=i.namespace&&i.key,T=pe.a(a,i);Object(r.useEffect)((function(){d(On()).then((function(e){return p(e)})).catch((function(e){return console.error(e)}))}),[d]);var x=function(e,t){z.a.patch("/api/settings/".concat(a.id),Object(S.a)({is_collect_data:e},t&&{app_insight_has_init:t})).then((function(){var t=sn();if(!t)throw Error("App Insight hasnot been initialize");t.config.disableTelemetry=!e,window.location.reload()})).catch((function(e){p(f),C(e)}))};return Object(r.useEffect)((function(){-1!==a.id&&d(jn())}),[d,a.id]),c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,"Setting"),c.a.createElement(Qt.a,{color:"grey",design:{paddingBottom:"10px"}}),c.a.createElement(V.a,{gap:"gap.large",design:{height:"80%"}},c.a.createElement(V.a,{column:!0,gap:"gap.large",design:{width:"50%"}},c.a.createElement(J.a,{size:"large",weight:"bold"},"Azure Cognitive Services Settings:"),c.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"100px auto 50px",gridTemplateRows:"auto auto",rowGap:"30px"}},c.a.createElement(J.a,{size:"large"},"Endpoint:"),c.a.createElement(ee.a,{value:a.namespace,onChange:function(e,t){var n=t.value;d({type:"UPDATE_NAMESPACE",payload:n})},fluid:!0}),c.a.createElement(ht.a,{trigger:c.a.createElement(ae.a,{text:!0,icon:c.a.createElement(re.QuestionCircleIcon,null),iconOnly:!0,onClick:function(){return v(!0)}}),content:"Where to get Endpoint and Key?"}),c.a.createElement(Z.a,{open:b,header:"Get Endpoint and Key",content:c.a.createElement(V.a,{column:!0,styles:{maxHeight:"800px",overflow:"scroll"}},c.a.createElement("p",null,"Step 1: Login Custom vision,"," ",c.a.createElement("a",{href:"https://www.customvision.ai/",target:"_blank",rel:"noopener noreferrer"},"https://www.customvision.ai/")),c.a.createElement("p",null,"Step 2: Click on the setting icon on the top"),c.a.createElement("img",{src:"/icons/guide_step_2.png",style:{width:"100%"}}),c.a.createElement("p",null,'Step 3: Choose the resources under the account, you will see information of "Key" and "Endpoint"'),c.a.createElement("img",{src:"/icons/guide_step_3.png",style:{width:"100%"}})),confirmButton:"Close",onConfirm:function(){return v(!1)}}),c.a.createElement(J.a,{size:"large"},"Key:"),c.a.createElement(ee.a,{value:a.key,onChange:function(e,t){var n=t.value;d({type:"UPDATE_KEY",payload:n})},fluid:!0})),c.a.createElement(V.a,{gap:"gap.large"},c.a.createElement(Mt,{onConfirm:function(){d((function(e,t){var n=t().setting.current,a=-1===n.id,r=a?"/api/settings/":"/api/settings/".concat(n.id,"/"),c=a?{data:{training_key:n.key,endpoint:n.namespace,name:"",iot_hub_connection_string:"",device_id:"",module_id:""},method:"POST"}:{data:{training_key:n.key,endpoint:n.namespace},method:"PUT"};return e({type:"REQUEST_START"}),z()(r,c).then((function(t){var n=t.data;e(vn({loading:!1,error:null,current:{id:n.id,key:n.training_key,namespace:n.endpoint},origin:{id:n.id,key:n.training_key,namespace:n.endpoint},isTrainerValid:n.is_trainer_valid,appInsightHasInit:n.app_insight_has_init}))})).catch((function(t){e(yn(t))}))})).then((function(){window.location.reload()})).catch((function(e){return console.error(e)}))},trigger:c.a.createElement(ae.a,{primary:!0,disabled:T||t,loading:t},I?"Update":"Save"),contentText:c.a.createElement("p",null,"Update Key / Namespace will remove all the parts, sure you want to update?")}),c.a.createElement(ae.a,{primary:!0,as:U.b,to:o?"/":"setting"},"Cancel")),n?c.a.createElement(be.a,{danger:!0,content:"".concat(n.message),dismissible:!0}):null,j?c.a.createElement(be.a,{danger:!0,content:"".concat(j.message),dismissible:!0}):null),o&&c.a.createElement(In,{cvProjects:u})),c.a.createElement(Qt.a,{color:"grey"}),c.a.createElement(ve.a,{label:"Allow to Send Usage Data",toggle:!0,checked:f,onChange:function(){var e=!f;p(e),x(e)}}),c.a.createElement(Mt,{contentText:c.a.createElement("p",null,"Allow to Send Usage Data?"),open:!s,confirmButton:"Yes",cancelButton:"No",onConfirm:function(){return x(!0,!0)},onCancel:function(){return x(!1,!0)}}))},Sn=[{header:"+ Create New Project",content:{key:"NEW"}}],In=function(e){var t=e.cvProjects,n=void 0===t?{}:t,a=Gt(!1),i=a.isLoading,o=a.error,u=a.data,s=a.originData,d=Object(r.useState)(!1),m=Object(D.a)(d,2),g=m[0],f=m[1],p=Object(r.useState)(!1),E=Object(D.a)(p,2),h=E[0],b=E[1],v=Object(r.useState)(null),y=Object(D.a)(v,2),O=y[0],j=y[1],I=Object(r.useState)(!1),T=Object(D.a)(I,2),x=T[0],_=T[1],A=Object(r.useState)(""),w=Object(D.a)(A,2),k=w[0],R=w[1],P=Object(r.useState)(""),L=Object(D.a)(P,2),M=L[0],N=L[1],U=Object(l.b)(),F=function(){var e=Object(ge.a)(me.a.mark((function e(){return me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,z.a.get("/api/projects/".concat(u.id,"/reset_project?project_name=").concat(k));case 4:U(ze(!1)),U(jn()),N("Create Project Success"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),j(e.t0);case 12:b(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){var e=!1;return M&&setTimeout((function(){e||N("")}),3e3),function(){e=!0}}));var G=[].concat(Sn,Object(C.a)(Object.entries(n).map((function(e){var t=Object(D.a)(e,2),n=t[0];return{header:t[1],content:{key:n}}})))),B=h||i,H=[O,o].filter((function(e){return!!e})),q=G.find((function(e){return e.content.key===u.cvProjectId}));return c.a.createElement(c.a.Fragment,null,c.a.createElement(Qt.a,{color:"grey",vertical:!0,styles:{height:"100%"}}),c.a.createElement(V.a,{column:!0,gap:"gap.large"},c.a.createElement(J.a,{size:"large",weight:"bold"},"Projects:"," "),c.a.createElement(nt.a,{items:G,onChange:function(e,t){null===t.value?U(Ge({cvProjectId:u.cvProjectId})):t.value.content.key===Sn[0].content.key?_(!0):U(Ge({cvProjectId:t.value.content.key}))},value:q}),g&&"NEW"!==u.cvProjectId&&c.a.createElement(ve.a,{checked:g,label:"Load Full Images",onClick:function(){return f((function(e){return!e}))}}),!g&&"NEW"!==u.cvProjectId&&c.a.createElement(Mt,{contentText:c.a.createElement("p",null,"Depends on the number of images, loading full images takes time"),onConfirm:function(){return f((function(e){return!e}))},trigger:c.a.createElement(ve.a,{checked:g,label:"Load Full Images"})}),"NEW"===u.cvProjectId&&c.a.createElement(ee.a,{placeholder:"Input a project name",fluid:!0,onChange:function(e,t){var n=t.value;R(n)}}),"NEW"===u.cvProjectId?c.a.createElement(ae.a,{primary:!0,content:"Create",disabled:B,loading:B,onClick:F}):c.a.createElement(Mt,{contentText:c.a.createElement("p",null,"Load Project will remove all the parts, sure you want to do that?"),onConfirm:function(){b(!0),z.a.get("/api/projects/".concat(u.id,"/pull_cv_project?customvision_project_id=").concat(u.cvProjectId,"&partial=").concat(Number(!g))).then((function(){U({type:"UPDATE_ORIGIN_PROJECT_DATA"}),N("Load Project Success")})).catch((function(e){return j(e)})).finally((function(){return b(!1)}))},trigger:c.a.createElement(ae.a,{primary:!0,content:"Load",disabled:!g&&u.cvProjectId===s.cvProjectId||B,loading:B})}),c.a.createElement(Mt,{contentText:c.a.createElement("p",null,"Create New Project will remove all the parts, sure you want to do that?"),open:x,onConfirm:function(){_(!1),U(Ge(Object(S.a)({},u,{cvProjectId:"NEW"})))},onCancel:function(){return _(!1)}}),H.length?c.a.createElement(be.a,{danger:!0,content:"Failed to load ".concat(H.join(", ")),dismissible:!0}):null,M&&c.a.createElement(be.a,{dismissible:!0,header:M,success:!0,visible:!0})))},Tn=function(e){var t=e.component,n=Object(Yt.a)(e,["component"]),a=Object(l.c)((function(e){return e.setting.isTrainerValid})),i=Object(l.b)();return Object(r.useEffect)((function(){i(On())}),[i]),a?c.a.createElement(B.c,Object.assign({},n,{component:t})):c.a.createElement(B.c,Object.assign({},n,{render:function(){return c.a.createElement(B.b,{to:"/setting"})}}))},xn=function(){return c.a.createElement(B.e,null,c.a.createElement(Tn,{path:"/manual",component:tn}),c.a.createElement(Tn,{path:"/locations/detail",component:Kt}),c.a.createElement(Tn,{path:"/locations",component:Wt}),c.a.createElement(Tn,{path:"/cameras/detail",component:Ze}),c.a.createElement(Tn,{path:"/cameras",component:oe}),c.a.createElement(Tn,{path:"/parts/detail",component:zt}),c.a.createElement(Tn,{path:"/parts",component:nn}),c.a.createElement(Tn,{path:"/partIdentification",component:pn}),c.a.createElement(B.c,{path:"/setting",component:Cn}),c.a.createElement(Tn,{path:"/",component:W}))},_n=n(251),An=function(e){var t=e.disabled,n=Object(B.i)().pathname;if("/"===n)return c.a.createElement(J.a,{color:"black"},"Home");var a=n.split("/").slice(1).reduce((function(e,t){var n=function(e){switch(e){case"cameras":return"Camera";case"parts":return"Part";case"locations":return"Location";case"register":return"Register";case"label":return"Label";case"manual":return"Identify Manually";case"detail":return"Details";case"partIdentification":return"Job Configuration";case"capturePhotos":case"uploadPhotos":return null;default:return"string"===typeof e?"Details":null}}(t);if(!n)return e;var a="".concat(e.path,"/").concat(t);return{pathTitles:[].concat(Object(C.a)(e.pathTitles),[{title:n,to:a}]),path:a}}),{pathTitles:[],path:""}).pathTitles;return c.a.createElement(V.a,{gap:"gap.smaller"},c.a.createElement(U.b,{to:"/",style:{color:"#0094d8",textDecoration:"none",cursor:t&&"default"},onClick:function(e){t&&e.preventDefault()}},c.a.createElement(J.a,null,"Home")),a.map((function(e,t,n){return c.a.createElement(r.Fragment,{key:t},c.a.createElement(J.a,{color:"black"},">"),t===n.length-1?c.a.createElement(J.a,{color:"black"},e.title):c.a.createElement(U.b,{to:"".concat(e.to),style:{color:"#0094d8",textDecoration:"none"}},c.a.createElement(J.a,null,e.title)))})))},wn=function(e){var t=e.src,n=e.to,a=e.disabled;return c.a.createElement(U.c,{to:n,style:{display:"flex",justifyContent:"center",padding:"0.8em",cursor:a&&"default"},activeStyle:{backgroundColor:"rgba(250, 83, 5, 0.5)"},onClick:function(e){a&&e.preventDefault()}},c.a.createElement(H.a,{src:t,design:{width:"100%"}}))},kn=Object(r.memo)((function(e){var t=e.styles,n=e.disabled,a=Gt(!1),r=at().find((function(e){return e.id===a.data.camera}));return c.a.createElement(_n.a,{color:"grey",inverted:!0,styles:Object(S.a)({},t,{padding:0,paddingTop:"1em"})},c.a.createElement(V.a,{column:!0,gap:"gap.large",hAlign:"center"},c.a.createElement(wn,{disabled:n,src:"/icons/location.png",to:"/locations"}),c.a.createElement(wn,{disabled:n,src:"/icons/camera.png",to:r?"/cameras/detail?name=".concat(r.name):"/cameras"}),c.a.createElement(wn,{disabled:n,src:"/icons/part.png",to:"/parts"}),c.a.createElement(wn,{disabled:n,src:"/icons/partIdentification.png",to:"/partIdentification"}),c.a.createElement(wn,{disabled:n,src:"/icons/manual.png",to:"/manual"})))})),Rn=function(e){var t=e.children,n=Object(l.c)((function(e){return e.setting.isTrainerValid}));return c.a.createElement(Q.a,{columns:"60px auto",rows:"50px auto",design:{height:"100vh"},styles:{justifyContent:"stretch"}},c.a.createElement(Pn,{disabled:!n}),c.a.createElement(kn,{styles:{gridColumn:"1 / span 1",gridRow:"2 / span 1",boxShadow:"1px 0px 10px 0px rgba(0,0,0,0.75)",zIndex:1},disabled:!n}),c.a.createElement(_n.a,{styles:{gridColumn:"span 1",padding:"30px"}},c.a.createElement(An,{disabled:!n}),t))},Pn=function(e){var t=e.disabled;return c.a.createElement(V.a,{space:"between",vAlign:"center",padding:"padding.medium",styles:{backgroundColor:"#0094d8",gridColumn:"1 / span 2",boxShadow:"0px 1px 10px 0px rgba(0,0,0,0.75)",zIndex:2,fontSize:"20px",padding:"0.5em 1em"}},c.a.createElement(V.a,{gap:"gap.large",vAlign:"center"},c.a.createElement(U.c,{to:"/",style:{textDecoration:"none",cursor:t&&"default"},onClick:function(e){t&&e.preventDefault()}},c.a.createElement(V.a,{gap:"gap.medium"},c.a.createElement(H.a,{src:"/icons/Home_white.png",design:{width:"30px"}}),c.a.createElement(J.a,{color:"white"},"Vision on Edge")))),c.a.createElement(V.a,{vAlign:"center",hAlign:"end",gap:"gap.medium",styles:{height:"100%"},onClick:function(e){t&&e.preventDefault()}},c.a.createElement(U.b,{to:"/setting",style:{height:"100%",cursor:t&&"default"}},c.a.createElement(H.a,{styles:{height:"100%"},src:"/icons/setting.png"})),c.a.createElement(J.a,{color:"white"},"User")))},Ln=n(974),Mn=Object(B.j)(Object(Ln.a)(un.reactPlugin,(function(e){var t=e.instrumentationKey,n=e.isAppInsightOn,a=e.history,i=e.children,o=Object(r.useRef)(!1);return Object(r.useEffect)((function(){var e=t;!o.current&&Boolean(e)&&Boolean(a)&&(un.initialize(e,n,a),o.current=!0)}),[a,t,n]),c.a.createElement(c.a.Fragment,null,i)}),"TelemetryProvider")),Nn=function(){var e=Object(r.useState)({key:"",isAppInsightOn:!1}),t=Object(D.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){var e=z.a.get("/api/appinsight/key"),t=z.a.get("/api/settings/");z.a.all([e,t]).then(z.a.spread((function(){var e=arguments.length<=0?void 0:arguments[0],t=e.data,n=arguments.length<=1?void 0:arguments[1],r=n.data;if(t.key)return a({key:t.key,isAppInsightOn:r[0].is_collect_data});throw new Error("No API Key")}))).catch((function(e){return console.error(e)}))}),[]),c.a.createElement(F.a,{theme:Dt},c.a.createElement(U.a,null,c.a.createElement(Mn,{instrumentationKey:n.key,isAppInsightOn:n.isAppInsightOn},c.a.createElement("div",{className:"App"},c.a.createElement(Rn,null,c.a.createElement(xn,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Dn=N(O),Un=Dn.store,Fn=Dn.persistor;o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(l.a,{store:Un},c.a.createElement(u.a,{loading:c.a.createElement("div",null,"Loading.."),persistor:Fn},c.a.createElement(Nn,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[706,1,2]]]);
//# sourceMappingURL=main.ecfa80be.chunk.js.map